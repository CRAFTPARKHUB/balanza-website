import{a as ba}from"https://app.framerstatic.com/chunk-G5HAYSP5.mjs";import"https://app.framerstatic.com/chunk-5HQOOAHT.mjs";import{a as Me}from"https://app.framerstatic.com/chunk-I4U4WH4U.mjs";import{a as Ua}from"https://app.framerstatic.com/chunk-ZDS6BDCL.mjs";import{a as xa,b as Ia,c as Fa}from"https://app.framerstatic.com/chunk-FMNW5N2U.mjs";import"https://app.framerstatic.com/chunk-6UJMWNYV.mjs";import"https://app.framerstatic.com/chunk-I2LP6MOL.mjs";import"https://app.framerstatic.com/chunk-LMHPW6T4.mjs";import{Bc as xt,Dc as ca,Ic as fa,Mb as tn,Nb as Ji,Nc as da,Oc as pa,Qc as ma,Rb as Qi,Rc as ua,Sb as $i,Sc as ga,Va as Vi,Vc as ya,Wc as ha,Xa as Ki,Xc as oo,_c as B,a as Jt,ad as wa,b as Bi,bc as ea,bd as Ca,c as Ai,cc as ta,d as _i,db as Xi,dc as oa,dd as nn,e as Mi,ec as na,fc as ra,gb as Zi,ic as ia,j as Qt,k as Ri,l as $t,n as eo,o as to,p as Di,r as Ti,sc as aa,t as Gi,tc as sa,u as zi,v as Li,va as $o,wc as on,xc as la,ya as en}from"https://app.framerstatic.com/chunk-7QU7GPZP.mjs";import"https://app.framerstatic.com/chunk-KYXBA6HV.mjs";import{b as _e}from"https://app.framerstatic.com/chunk-AYVLZMY5.mjs";import{h as Oi}from"https://app.framerstatic.com/chunk-JU44VUXB.mjs";import{r as Ii}from"https://app.framerstatic.com/chunk-ELR3QNRC.mjs";import"https://app.framerstatic.com/chunk-IHOAENGB.mjs";import{E as wt,F as Ct,H as G,I as ei,J as ti,K as oi,L as ni,M as ri,N as ii,O as ai,P as si,Q as jt,S as li,T as Yt,aa as fi,ia as di,kb as Ci,lb as Ui,mb as xi,ta as pi,ua as yi,va as Ht,wa as hi}from"https://app.framerstatic.com/chunk-GAQADUCU.mjs";import{a as gi,j as Fi,m as bi}from"https://app.framerstatic.com/chunk-JRXTRNIF.mjs";import"https://app.framerstatic.com/chunk-6TTJU3MI.mjs";import{Ab as Jr,Cf as ci,Qd as $r,ja as Kr,jb as jr,ma as Zt,na as C,oa as Xr,qb as Hr}from"https://app.framerstatic.com/chunk-EZIGDFNB.mjs";import"https://app.framerstatic.com/chunk-7MXPQYQK.mjs";import{e as Qr}from"https://app.framerstatic.com/chunk-ZSVCGQV4.mjs";import"https://app.framerstatic.com/chunk-R2C6SYZL.mjs";import"https://app.framerstatic.com/chunk-JRBFLTNY.mjs";import"https://app.framerstatic.com/chunk-N57XNHE3.mjs";import"https://app.framerstatic.com/chunk-R56BHGFV.mjs";import"https://app.framerstatic.com/chunk-6463HVPD.mjs";import"https://app.framerstatic.com/chunk-P6LO7Y3T.mjs";import"https://app.framerstatic.com/chunk-JB3A7NVR.mjs";import"https://app.framerstatic.com/chunk-HTH46QE2.mjs";import"https://app.framerstatic.com/chunk-BQK5PZHM.mjs";import{a as Ni}from"https://app.framerstatic.com/chunk-V67MTYNI.mjs";import"https://app.framerstatic.com/chunk-QV4FOHOG.mjs";import"https://app.framerstatic.com/chunk-QKJFX767.mjs";import"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import"https://app.framerstatic.com/chunk-AA5GWJJ6.mjs";import"https://app.framerstatic.com/chunk-A2C2SO3Y.mjs";import"https://app.framerstatic.com/chunk-YE25YANI.mjs";import{a as Zr,b as ht}from"https://app.framerstatic.com/chunk-WHMMCPJJ.mjs";import"https://app.framerstatic.com/chunk-6AASYNWV.mjs";import"https://app.framerstatic.com/chunk-YOVAIBKA.mjs";import{b as Wi}from"https://app.framerstatic.com/chunk-G7DIBGUA.mjs";import"https://app.framerstatic.com/chunk-FQUBPV2J.mjs";import"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{d as Vr}from"https://app.framerstatic.com/chunk-FUVQGT35.mjs";import"https://app.framerstatic.com/chunk-E345PSYW.mjs";import{a as Yi,d as Hi}from"https://app.framerstatic.com/chunk-KTFSGLT2.mjs";import"https://app.framerstatic.com/chunk-5Q7SE4MY.mjs";import"https://app.framerstatic.com/chunk-47LSD5EM.mjs";import"https://app.framerstatic.com/chunk-EZ7MH3HB.mjs";import{a as rt}from"https://app.framerstatic.com/chunk-7GSEC7H4.mjs";import"https://app.framerstatic.com/chunk-ERQ2KS7Q.mjs";import"https://app.framerstatic.com/chunk-ITPH43YU.mjs";import{a as qi}from"https://app.framerstatic.com/chunk-LRDLYUYQ.mjs";import{a as Pi}from"https://app.framerstatic.com/chunk-GH3Y5CSO.mjs";import{b as ui,r as wi}from"https://app.framerstatic.com/chunk-RU5O5FZQ.mjs";import{e as Ut,f as mi}from"https://app.framerstatic.com/chunk-SUC4I7FB.mjs";import{a as Yr,j as ee}from"https://app.framerstatic.com/chunk-3ASAZPNM.mjs";import"https://app.framerstatic.com/chunk-PABHF7FN.mjs";import{Ia as pr,Ig as Ir,Ld as Ho,Md as Jo,Ug as Fr,Wg as br,ac as mr,be as wr,ce as Cr,de as Ur,ee as xr,id as ur,jd as M,ka as Yo,vd as yr,wd as hr}from"https://app.framerstatic.com/chunk-DAU7HSZF.mjs";import"https://app.framerstatic.com/chunk-5E2OZGDR.mjs";import"https://app.framerstatic.com/chunk-UJZ2TDVM.mjs";import{e as gr,f as K}from"https://app.framerstatic.com/chunk-CW5JUS4I.mjs";import"https://app.framerstatic.com/chunk-V4TANWPK.mjs";import"https://app.framerstatic.com/chunk-2L7FC5IH.mjs";import{b as ji}from"https://app.framerstatic.com/chunk-JA2ODPCI.mjs";import"https://app.framerstatic.com/chunk-TVYYAEV6.mjs";import{Bc as Nr,Ee as Qo,G as Er,Gc as Or,Gf as zr,H as Pr,Ie as _r,Le as qt,Se as Wt,We as Mr,Xe as Rr,Ye as Dr,ab as Lt,ag as Lr,b as kr,bg as qr,je as Br,me as Ar,pf as Tr,se as k,sf as Vt,tf as Kt,uf as Xt,vg as Wr,wf as Gr,ye as T}from"https://app.framerstatic.com/chunk-N4BEROE5.mjs";import"https://app.framerstatic.com/chunk-25W4MKKO.mjs";import"https://app.framerstatic.com/chunk-O3DFIQHJ.mjs";import"https://app.framerstatic.com/chunk-HHZD2RYV.mjs";import"https://app.framerstatic.com/chunk-RLD2AJHB.mjs";import"https://app.framerstatic.com/chunk-L4JV7UON.mjs";import{a as vi}from"https://app.framerstatic.com/chunk-VJBLPHHY.mjs";import{a as W}from"https://app.framerstatic.com/chunk-QFU6OGL3.mjs";import{a as Si,b as ki,c as Ei}from"https://app.framerstatic.com/chunk-CTKJD4ES.mjs";import"https://app.framerstatic.com/chunk-IOFOBNNW.mjs";import{Jd as fr,We as dr,rc as S,ub as cr}from"https://app.framerstatic.com/chunk-CZVTQEKL.mjs";import{$l as nr,Ai as Jn,Ao as rr,Dd as Yn,Hb as Kn,Id as A,Jd as fe,L as Oe,Md as Tt,Ml as tr,Nd as We,Q as qe,Qc as Zn,Rq as yt,Sc as jn,Tq as Ve,Uc as ke,X as gt,Yl as de,Yq as Gt,Zo as ir,_l as or,ck as er,ct as lr,dj as Qn,gu as zt,ic as Xn,jc as O,ki as Ko,l as L,lb as Wn,ll as Zo,ls as ar,ms as sr,ol as jo,pb as J,rb as Vn,tj as $n,ua as Be,wi as Xo,x as Tn}from"https://app.framerstatic.com/chunk-YIQ5HVZM.mjs";import"https://app.framerstatic.com/chunk-VXJAAVJQ.mjs";import"https://app.framerstatic.com/chunk-5DSVU7DA.mjs";import"https://app.framerstatic.com/chunk-KD4H3DLZ.mjs";import"https://app.framerstatic.com/chunk-4DUBS6C5.mjs";import"https://app.framerstatic.com/chunk-XX4R3RQ6.mjs";import"https://app.framerstatic.com/chunk-XAFQO7US.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-4I3XDWXC.mjs";import"https://app.framerstatic.com/chunk-POQKH4YA.mjs";import{a as v,b as ot}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import"https://app.framerstatic.com/chunk-WAAMG33M.mjs";import{e as Sr,g as vr,i as ae}from"https://app.framerstatic.com/chunk-XWEO5KIO.mjs";import"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{H as Hn,k as Gn,r as zn,s as Ln}from"https://app.framerstatic.com/chunk-5NKPNTS7.mjs";import{b as ie,d as qn,e as Ae,i as Ce}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Pd as _l,Vc as q,a as $,b as g,sc as nt}from"https://app.framerstatic.com/chunk-M7LXWNTO.mjs";import"https://app.framerstatic.com/chunk-PFHOMMMY.mjs";import"https://app.framerstatic.com/chunk-72P4HPJP.mjs";import"https://app.framerstatic.com/chunk-WIUFUKXG.mjs";import{$ as Dn,aa as tt,i as Mt,k as H,o as Rt}from"https://app.framerstatic.com/chunk-GQILM44Y.mjs";import{a as y,b as Vo}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as Dt}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as m,j as p,k as Le,l as At,m as _t}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var va=m(g()),Ml={BooleanControlPropRow:xa,EnumControlPropRow:aa,StringControlPropRow:xt};function Sa({children:n}){return(0,va.jsx)(Xi.Provider,{value:Ml,children:n})}var rn="data-chrome";function ka(n){return n instanceof HTMLElement?n.closest(`[${rn}]`)!==null:!1}function Ea(){return window}function an(){return Ea().secureFrameAncestors}function it(){v(an(),"Must have secure frame ancestors.")}var go=m($()),Ls=m(_l());var Pa="chromeHidden_c1gxt05z",Na="nonHudChromeWrapper_n1sd5akc";var ro=m($());var Oa="modal_m1cvfiap",Ba="form_f1nz04q2",Aa="scroll_syo0l7n",_a="width100_w9541mz",Ma="editor_e73gufq";var Ke=m(g()),Tl=["left","right","auto-vertical"];function Da({controlKey:n,nodeId:o}){let e=M(),t=()=>{e.stores.modalStore.dismiss()},r=_e(()=>{let l=e.stores.treeStore.tree.get(o);return!We(l)&&!fe(l)?null:l},[o],["Tree"]),i=_e(()=>{let c=e.tree.getScopeNodeFor(r);return c?Jr(c):null},[r],["Tree"]),s=_e(()=>{if(We(r)){let c=r?.parentid,l=e.stores.treeStore.tree,u=l.getNodeWithTrait(c,Tt);if(!u)return null;let U=u.getPropertyControls(l)[n];return U?.type==="richtext"?U:null}if(fe(r)){let c=L.reactComponentForIdentifier(r.codeComponentIdentifier);if(!c)return null;let l=c.properties[n];return l?.type==="richtext"?l:null}return null},[n,r],["Tree","ActiveBundle"]),f=(0,ro.useMemo)(()=>{if(!r)return"";let c=Ra(r,n);return ie(c?.value)?c.value:""},[r,n]),a=!!i&&!!r&&s?.type==="richtext",d=c=>{if(!r)return;let l=e.stores.treeStore.tree.current(r);if(!l)return;let u,w=Ra(r,n);w?u={...w,value:c}:u={type:"richtext",value:c},We(l),l.setControlProp(n,u),y(Xr(e),"Only on-page engine can commit tree"),e.stores.projectStore.commitTreeAndSend()};return(0,ro.useEffect)(()=>{a||e.stores.modalStore.dismiss()},[a]),a?(0,Ke.jsxs)(Vt,{visible:!0,hasBackdrop:!0,onDismiss:t,className:Oa,formClassName:Ba,children:[(0,Ke.jsx)(Kt,{separator:!0,title:s.title??"Unknown",className:_a,children:(0,Ke.jsx)(Xt,{onDismiss:t})}),(0,Ke.jsx)(Dr,{className:Aa,children:(0,Ke.jsx)(oo,{enabled:!0,supportsEmbeds:Xo(r),supportsMedia:Xo(r),className:Ma,defaultValue:f,onChange:d,scopeType:i,onUnsavedChange:rt,popoverAttachmentEdge:Tl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0})})]}):null}function Ra(n,o){if(We(n)){let e=n.getControlProp(o);return e?.type==="richtext"&&ie(e.value)?e:null}if(fe(n)){let e=L.reactComponentForIdentifier(n.codeComponentIdentifier);if(!e)return null;let r=n.getControlProps(e.properties)[o];if(r?.type==="richtext"&&ie(r.value))return r}return null}var io=m(g()),zl={AcquireAddonModal:null,AcquireAdvancedAnalyticsTrialModal:null,AddToLibrary:null,BatchTranslate:null,CMSImport:null,CodeFileCreation:null,CompleteSignup:null,ComponentIsolationModal:null,Confirmation:null,ConfirmBatchTranslateAll:null,ConfirmDefaultLanguage:null,ConfirmDeleteCollectionItems:null,ConfirmDraftCollectionItem:null,ConfirmDraftLocale:null,ConfirmDraftPage:null,ConfirmPublishAbTest:null,ConfirmPublishDraftCollectionItem:null,ConfirmPublishDraftLocale:null,ConfirmPublishDraftPage:null,ConfirmRemoveTriggerEvent:null,ConfirmUpdatingAbVariants:null,ConvertToCMSPage:null,CreateAbTest:null,CreateComponent:null,CreateLayoutTemplate:null,CreateManagedCollection:null,CreateTeam:null,CSVImportConflict:null,CustomBreakpoint:null,DeleteCodeFile:null,DeleteCustomFont:null,DeleteEntityFolder:null,DeleteFile:null,DeprecatedDrafts:null,DuplicateProjectWithVersion:null,DuplicateWebPage:null,FigmaImportTutorial:null,ImageCrop:na,ImageFocalPoint:ra,ImportFigma:null,ImportRedirects:null,LoadingFullDocument:null,LocaleReady:null,LocaleSettings:null,LocalizationGlossary:null,None:null,NudgePreferences:null,OverrideFile:null,PasteFromFigma:null,PlanCancellation:null,PluginCustomHTML:null,PluginFromURL:null,PluginWithModePicker:null,RichTextEditor:Da,PublishModule:null,QuickActions:null,RemoveTeamLibraryModule:null,ReplaceTextStylePreset:null,ReplaceWebPage:null,SelectProjectToUpgrade:null,Shortcuts:null,StopAbTest:null,SubscriptionNotInOrder:null,TransferProject:null,UnlinkComponent:null,UnsavedChanges:null,UnsupportedFileSize:null,UnsupportedFileType:null,UpgradeDocument:null,UpsellEnterprise:null,UpsellFeature:null,Variables:null,VectorImport:null,VectorSetCreation:null,Welcome:null};function Ta(){let n=C(),{type:o,...e}=n.stores.modalStore.useState(i=>i.active);if(o==="None")return;let t=zl[o];y(t,"Modal is missing");let r=Oi(o);return(0,io.jsx)(_r,{allowFocusTrap:!0,children:(0,io.jsx)(Tr.Provider,{value:r,children:(0,io.jsx)(t,{...e})})})}var Re="EDITOR_BAR_DEVICE_PREFERENCE",sn="EDITOR_BAR_MENU_SEEN";function ao({accessStore:n,activeRouteStore:o},e,t){let r=n.access;y(r.status==="success","Can't open Framer if project access is not successful");let i=t||localStorage.getItem(Re)==="app",s=e??o.projectLinkNodeId,f=`${Dt().app}/projects/${r.data.projectSlug}?node=${s}`;i?window.open(`https://www.framer.com/open-in-app?url=${encodeURIComponent(f)}`,"_blank"):window.open(f,"FramerStudio")}var lo=m($());var cn=m(g());function Ga({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return v(a?.type==="boolean"),(0,cn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,cn.jsx)(ca,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)}})})}var za="onPageCMSFieldsModal_o1kosemn",La="onPageCMSFieldsModalHeader_o1tcokht",qa="onPageCMSFieldsModalBody_o11jr4ka",Ll=1,Wa=ae.panelPadding+Ll,Va="onPageCMSFieldsModalButtonContainer_oaqx903",fn="button_b1gqim6f";var Ka="wrapper_wje69dc",Xa="input_i1rqgchl",Za="icon_ixghur2",ja="collectionInputHeight_c1d0unc6";var dn=m(g());function Ya({collectionNode:n,controlProp:o,variableId:e,warningMessage:t,onChange:r}){let i=M(),f=n.getPropertyControls(i.tree)[e];v(f?.type==="collectionreference");let a=ar(f,o);v(!O(a),"Variables are not supported");let d=f.dataIdentifier;function c(l){r(e,{type:"collectionreference",value:l})}return(0,dn.jsx)(B,{title:f.title??"",warningMessage:t,children:(0,dn.jsx)(ia,{large:!0,value:a,onChange:c,className:Xa,dataIdentifier:d,wrapperClassName:J(Ka,ja),iconClassName:Za,overrideTheme:"onPageEditing"})})}var pn=m(g());function Ha({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return v(a?.type==="date"),(0,pn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,pn.jsx)(da,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)},required:!1})})}var mn=m(g());function Ja({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return v(a?.type==="enum"),(0,mn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,mn.jsx)(pa,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)}})})}var un=m(g());function Qa({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];if(v(a?.type==="file"),v(!ke(e?.value),"Dynamic values are not supported within required field validation"),e&&e?.type!=="file")return null;let c=(e?.value??"").split(".").pop(),l=!c||a.allowedFileTypes.length===0||a.allowedFileTypes.includes(c);return(0,un.jsx)(B,{title:a.title??"",warningMessage:r,showWarningTint:!l,children:(0,un.jsx)(ma,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:u=>{ee(u)&&i(t,u)},reset:()=>{i(t,{type:"file",value:void 0})}})})}var gn=m(g());function $a({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,onChange:r}){let i=M(),s=Ni(w=>{let U=w(e);U&&r(t,U)});if(!n)return null;let a=o.getPropertyControls(i.tree)[t];v(a?.type==="array"),v(!e||ir(e));let d=Di(e,a,!0),c=Ti(e,a,!0),u=to(d??c,a);return(0,gn.jsx)(B,{title:a.title??"",warningMessage:u,children:(0,gn.jsx)(ua,{collectionId:o.id,control:a,fieldId:t,controlProp:e,itemId:n.id,onChange:s,required:!1})})}var yn=m(g());function es({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return v(a?.type==="responsiveimage"),(0,yn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,yn.jsx)(ga,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{let c=d(e);ee(c)&&i(t,c)},reset:()=>{let d={type:"image",value:void 0};i(t,d)}})})}var hn=m(g());function ts({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return v(a?.type==="link"),(0,hn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,hn.jsx)(ya,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)},reset:()=>{let d={type:"link",value:void 0};i(t,d)}})})}var os="inputWrapper_i4uywus";var wn=m(g());function ns({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];y(a?.type==="multicollectionreference");let d=a.dataIdentifier,c=sr(a,e)??[];return y(!O(c),"Variables are not supported"),(0,wn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,wn.jsx)(la,{large:!0,value:c,onChange:l=>{i(t,{type:"multicollectionreference",value:l})},wrapperClassName:os,dataIdentifier:d,overrideTheme:"onPageEditing"})})}var Cn=m(g());function rs({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=M();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return v(a?.type==="number"),(0,Cn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,Cn.jsx)(ha,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)}})})}var Un=m(g()),Kl=["left","right","auto-vertical"];function is({control:n,collectionItemNode:o,controlProp:e,setControlProp:t,warningMessage:r}){let i=e&&Tn(e.value)?e.value:void 0,s=f=>{t({type:n.type,value:f})};return(0,Un.jsx)(B,{title:n.title??"",warningMessage:r,children:(0,Un.jsx)(oo,{enabled:!0,supportsEmbeds:!0,supportsMedia:!0,compactTagSelector:!0,defaultValue:i??"",onChange:s,scopeType:"ContentManagement",onUnsavedChange:rt,popoverAttachmentEdge:Kl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},o.id)})}var so=m(g());function as({control:n,collectionItemNode:o,controlProp:e,setControlProp:t,warningMessage:r}){let i=e&&ie(e.value)?e.value:void 0,s=n.placeholder,f=n.defaultValue??"",a=i??f,d=c=>{t({type:n.type,value:c})};return(0,so.jsx)(B,{title:n.title??"",warningMessage:r,children:n.displayTextArea?(0,so.jsx)(Mr,{value:a,onChange:d,constantChange:!0,placeholder:s,minRows:10,maxRows:30,className:Ca},o.id):(0,so.jsx)(Rr,{type:n.obscured?"password":"text",value:a,onChange:d,placeholder:s,constantChange:!0,className:fa})})}var P=m(g());function ss({onDiscard:n,onSave:o,fieldIdsToShow:e,type:t}){let[r,i]=(0,lo.useState)(()=>new Map),{canvasStore:s,treeStore:f}=C().stores,{collectionNode:a,collectionItemNode:d}=s.useState(),c=Xl({collectionNode:a,collectionItemNode:d,tempControlProps:r,fieldIdsToShow:e});function l(h){let x=a?.getPropertyControls(f.tree)?.[h];if(!x)return;let F=c.get(h);if(F?.type!=="required")return to(F,x)}let u=()=>{for(let[h,N]of r)f.tree.current(d)?.setControlProp(h,N);o()},w=(h,N)=>{i(x=>Dn.set(x,h,N))},U=()=>{Jt()||o()};return(0,P.jsxs)(Vt,{hasBackdrop:!0,className:za,visible:e.length>0,onDismiss:t==="allFields"?u:n,onConfirm:U,children:[(0,P.jsx)(Kt,{separator:!0,title:t==="requiredFields"?"Required Fields":"All Fields",className:La,children:(0,P.jsx)(Xt,{onDismiss:n})}),(0,P.jsxs)(Wr,{className:qa,children:[(0,P.jsx)(zr,{size:0}),e.map(h=>{if(!a)return null;let N=a.getVariable(h);if(!N)return null;let x=r.get(h)??d?.getControlProp(h),F=N.type;switch(F){case"slug":return!Ve(N)||!d?null:(0,P.jsx)(wa,{collectionNode:a,collectionItemNode:d,controlProp:x,setControlProp:E=>w(h,E),variable:N,warningMessage:l(h)},h);case"string":{if(!d)return null;let E=a.getPropertyControls(f.tree);if(!yt(N))return null;let b=E[h];return b?.type!=="string"?null:(0,P.jsx)(as,{control:b,collectionItemNode:d,controlProp:x,setControlProp:Se=>w(h,Se),warningMessage:l(h)},h)}case"richtext":{if(!d)return null;let b=a.getPropertyControls(f.tree)[h];return b?.type!=="richtext"?null:(0,P.jsx)(is,{control:b,collectionItemNode:d,controlProp:x,setControlProp:Se=>w(h,Se),warningMessage:l(h)},h)}case"link":return(0,P.jsx)(ts,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"image":return(0,P.jsx)(es,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"array":return(0,P.jsx)($a,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,onChange:w},h);case"multicollectionreference":return(0,P.jsx)(ns,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"collectionreference":return(0,P.jsx)(Ya,{collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"file":return(0,P.jsx)(Qa,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"date":return(0,P.jsx)(Ha,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"number":return(0,P.jsx)(rs,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"boolean":return(0,P.jsx)(Ga,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);case"enum":return(0,P.jsx)(Ja,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:h,warningMessage:l(h),onChange:w},h);default:ot(F)}})]}),(0,P.jsx)(Gr,{displayDivider:!1,paddingTop:Wa,className:Va,gap:ae.inputSpacing,children:(0,P.jsxs)(kr,{children:[(0,P.jsx)(T,{bold:!0,onClick:n,className:fn,children:(0,P.jsx)(Qo,{children:t==="requiredFields"?"Cancel":"Discard"})}),(0,P.jsx)(T,{bold:!0,enabled:c.size===0||t==="allFields",variant:"primary",type:"submit",onClick:u,className:fn,children:(0,P.jsx)(Qo,{children:"Save"})})]})})]})}function Xl({collectionNode:n,collectionItemNode:o,tempControlProps:e,fieldIdsToShow:t}){let r=C(),{tree:i}=r.stores.treeStore.useState(),s=Ri(n,o);return(0,lo.useMemo)(()=>{let f=new Map;if(!n||!o)return f;for(let a of t){let d=n.getVariable(a);if(!d)continue;let l=n.getPropertyControls(i)[a];if(!l)continue;let u=e.get(a)??o.getControlProp(a),w=s.get(a),U;(yt(d)||Ve(d))&&(U=$t(d,n.variables,o));let h=eo(d.type,l,u,U,void 0,Gt(d),w);h&&f.set(a,h)}return f},[n,o,t,s,i,e])}var ls="toolbar_t49i6vy",at="button_bjwo6qr",It="buttonSecondary_b1qwl3y9",cs="mainContentContainer_m1wta5up",fs="mainContent_m69kutt",xn="secondaryText_sdjdrec",ds="logoIcon_l9efojb";var I=m(g());function ms(){let n=C(),{canvasStore:o,activeRouteStore:e,projectStore:t}=n.stores,{isCreatingCollectionItem:r,modalState:i}=o.useState(),{hasPermanentlyFailed:s}=t.useState(),f=_e(()=>o.collectionNode,[],[o,e]),a=i.type==="finishEditing"&&i.isNewItem?"Page saved":"Site saved",d=()=>{i.type==="requiredFields"?n.stores.canvasStore.saveTemporaryCollectionItem():(n.stores.projectStore.commitTreeAndSend(),n.stores.canvasStore.resetModalState())},c=()=>{n.stores.canvasStore.resetModalState()};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:ls,children:[(0,I.jsxs)(T,{className:W(at,It),onClick:()=>ao(n.stores,i.type==="finishEditing"&&i.isNewItem?i.nodeId:void 0,!0),"aria-label":"Open in Framer",children:[(0,I.jsx)(Lt,{"aria-hidden":"true",className:ds}),(0,I.jsx)(co,{desktopText:"Open in Framer"})]}),(0,I.jsxs)("div",{className:cs,children:[(0,I.jsx)(ps,{desktopText:"Click to edit",mobileText:"Tap to edit",secondaryText:"Changes are auto-saved",isVisible:i.type!=="finishEditing"}),(0,I.jsx)(ps,{desktopText:a,mobileText:a,secondaryText:`A notification was sent to your collaborators. ${i.type==="finishEditing"&&i.isNewItem?"The page":"Changes"} will be visible when the project is published.`,isVisible:i.type==="finishEditing"})]}),(0,I.jsxs)(k,{direction:"row",gap:10,children:[f&&!r&&!f.managedByPlugin&&i.type!=="finishEditing"&&(0,I.jsxs)(T,{className:W(at,It),enabled:!s,onClick:()=>o.createTemporaryCollectionItem(),"aria-label":"Add Page",children:[(0,I.jsx)(Or,{}),(0,I.jsx)(co,{desktopText:"Add Page",mobileText:"Page"})]}),r&&!s&&(0,I.jsxs)(T,{className:W(at,It),onClick:()=>{n.stores.canvasStore.handleShowAllFields()},children:[(0,I.jsx)(Yl,{}),"Show All Fields"]}),i.type==="finishEditing"?(0,I.jsxs)(T,{className:W(at,It),onClick:()=>o.handleDismissFinishEditing(),children:[(0,I.jsx)(jl,{}),"Go Back to Site"]}):(0,I.jsxs)(T,{variant:"primary",className:at,onClick:()=>o.handleFinishEditing(),children:[(0,I.jsx)(Pr,{"aria-hidden":"true"}),(0,I.jsx)(co,{desktopText:"Finish Editing",mobileText:"Done"})]})]})]}),(i.type==="requiredFields"||i.type==="allFields")&&(0,I.jsx)(ss,{onDiscard:c,onSave:d,type:i.type,fieldIdsToShow:i.fieldIdsToShow})]})}function ps({desktopText:n,mobileText:o,secondaryText:e,isVisible:t}){return(0,I.jsx)(nt,{children:t&&(0,I.jsxs)(q.div,{className:fs,initial:{marginTop:10,opacity:0},animate:{marginTop:0,opacity:1},exit:{marginTop:-10,opacity:0},children:[(0,I.jsx)(co,{desktopText:n,mobileText:o}),(0,I.jsx)("span",{className:xn,children:"\xB7"}),(0,I.jsx)("span",{className:xn,children:e})]})})}function co({desktopText:n,mobileText:o}){let e=qi(`(max-width: ${Sr.tabletSmall}px)`);return!o&&e?null:(0,I.jsx)("span",{children:e?o:n})}function jl(){return(0,I.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"9",fill:"none",children:[(0,I.jsx)("path",{d:"M 1.5 7.5 L 8 1",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,I.jsx)("path",{d:"M 3 1 L 8 1 L 8 6",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})}function Yl(){return(0,I.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"11",fill:"none",children:[(0,I.jsx)("path",{d:"M1 5.5s1.5-3 4.5-3 4.5 3 4.5 3-1.5 3-4.5 3-4.5-3-4.5-3Z",fill:"transparent",strokeWidth:"1.5",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round"}),(0,I.jsx)("path",{d:"M5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z",fill:"#fff"})]})}var j=class{constructor(o){this.engine=o}};var Ue=class n extends j{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}getCodeComponentNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,fe)}getEditableControls(){let e=this.getCodeComponentNode();if(e)return n.getEditableControls(this.engine,e,this.renderId)}update(){let e=this.engine,t=this.getCodeComponentNode();(!t||!n.supportsNode(e,t,this.renderId))&&e.exitTool()}static getEditableControls(e,t,r){let i=t.cache.getRenderInstance(r);if(!i)return Mt();let s=L.reactComponentForIdentifier(t.codeComponentIdentifier);if(!s)return Mt();let f=t.getControlProps(s.properties);if(!f)return Mt();let a=[];for(let d in f){let c=f[d];if(!c)continue;let l=s.properties[d];if(l){if(c.type==="string"){if(O(c.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,c.type,i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(c.value)){y(l.type==="string");let u=Ct(l);y(u,"Reduced control prop should not be null"),wt(u,c,l),a.push({type:"component",controlKey:d,controlDescription:l,controlProp:c,reducedControlProp:u})}}if(c.type==="richtext"){if(O(c.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,c.type,i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(c.value)){y(l.type==="richtext");let u=Ct(l);y(u,"Reduced control prop should not be null"),wt(u,c,l),a.push({type:"component",controlKey:d,controlDescription:l,controlProp:c,reducedControlProp:u})}}if(c.type==="image"){if(O(c.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,c.type,i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(c.value)){y(l.type==="image"||l.type==="responsiveimage");let u=Ct(l);y(u,"Reduced control prop should not be null"),wt(u,c,l),a.push({type:"component",controlKey:d,controlDescription:l,controlProp:c,reducedControlProp:u})}}if(c.type==="date"){if(O(c.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,"date",i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(c.value)){y(l.type==="date");let u=Ct(l);y(u,"Reduced control prop should not be null"),wt(u,c,l),a.push({type:"component",controlKey:d,controlDescription:l,controlProp:c,reducedControlProp:u})}}if(c.type==="link"&&O(c.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,c.value,"link",i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}}}return a}static supportsNode(e,t,r){return fe(t)?n.getEditableControls(e,t,r).length>0:!1}};var xe=class n extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=n.getVariableReference(e);if(r)return G(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"date",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();(!t||!n.supportsNode(e,t,this.renderId))&&e.exitTool()}static getVariableReference(e){let t=e.textContent;if(!jn(t))return;let r=t.startValue;if(O(r))return r}static supportsNode(e,t,r){if(!A(t))return!1;let i=n.getVariableReference(t);if(!i)return!1;let s=t.cache.getRenderInstance(r);return s?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,i,"date",s.collectionItemId):!1}};var Ie=class n extends j{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}update(){let e=this.engine,t=e.tree.get(this.nodeId);(!t||!n.supportsNode(e,t,this.renderId))&&e.exitTool()}static supportsNode(e,t,r){if(!zt(t))return!1;if(O(t.fillImage)){let i=t.cache.getRenderInstance(r);return i?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,t.fillImage,"image",i.collectionItemId):!1}return!Zn(t.fillImage)}};var Hl=/^(?<hashes>#{1,6})\s$/u,pe=class n extends j{constructor(e,t,r,i="none"){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;p(this,"handleOnFocus",()=>this.proseMirrorEditor?.controls.handleOnFocus());p(this,"handleOnBlur",()=>this.proseMirrorEditor?.controls.handleOnBlur());p(this,"proseMirrorEditor",null);p(this,"hasTextFitViewBox",!1);this.engine.beginUndoGroup(),this.start()}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}update(){let e=this.getRichTextNode();if(!e||!n.supportsNode(e)){this.engine.exitTool();return}!e.textFitViewBoxSize||this.hasTextFitViewBox||this.engine.processWhenReady(()=>{xr(this.engine.tree,e)&&(this.hasTextFitViewBox=!0)})}async stop(){let e=this.getRichTextNode();e&&(e.cache.isEditable=!1),this.proseMirrorEditor?.destroy(),this.proseMirrorEditor=null,this.engine.endUndoGroup(),this.engine.stores.toolStore.proseMirrorView=null,this.engine.stores.toolStore.nodeInTextEditor=null}start(){let e=this.getRichTextNode();if(!e)return;this.engine.process(()=>{this.hasTextFitViewBox=wr(this.engine.tree,e)});let t=Yt(this.engine.tree,e);if(t.length===0){this.init();return}Oe.loadFonts(t).catch(H).finally(()=>this.init())}init(){this.startAsync().catch(e=>{H(e),this.engine.exitTool()})}async startAsync(){let e=this.getRichTextNode();if(!e)return this.engine.exitTool();this.proseMirrorEditor=await this.createProseMirrorEditor(e),e.cache.isEditable=!0,this.engine.stores.toolStore.proseMirrorView=this.proseMirrorEditor.view}async createProseMirrorEditor(e){let{baseKeymap:t,chainCommands:r,createParagraphNear:i,Decoration:s,DecorationSet:f,dropCursor:a,EditorView:d,ellipsis:c,emDash:l,gapCursor:u,history:w,InputRule:U,inputRules:h,keymap:N,liftEmptyBlock:x,liftListItem:F,newlineInCode:E,redo:b,sinkListItem:Se,splitBlock:qo,splitListItem:Nl,toggleMark:Wo,undo:Ol,undoInputRule:An}=await jt(),Q=this.engine,Bl=r(Nl(de.nodes.listItem),E,i,x,oi,ti,(Z,R)=>qo(Z,R&&(V=>{let Ne=Z.selection,$e=this.getRichTextNode();y($e,"RichTextNode not found");let we=Ne.$from.node(1);if(!jo(we)||!(Ne.$to.parentOffset===Ne.$to.parent.content.size))return R(V);let re={...we.attrs},ze=Zo(we)&&re.tag!=="p",ut=V.mapping.map(Z.selection.to),et=Z.selection.$from.marks();if(ze){let ve=$e.getNodeTextStylePreset(Q.tree,"p")??Ho(Q.tree,"p")??Yo.createDefault("p");Q.processWhenReady(()=>{Jo(Q,ve),$e.setNodeTextStylePreset(ve)}),re.textStylePreset=ve.id,re.tag="p",re.inlineStyles={},re.blockStyles={}}else{let ve=et.find(tr);re.inlineStyles={...re.inlineStyles,...ve?.attrs.inlineStyles}}V.setNodeMarkup(ut-1,void 0,re),V.setStoredMarks(et),ze&&V.removeStoredMark(de.marks.inlineStyles),R(V)}))),Al=Q.wrapHandler(()=>(Q.exitTool(),!0));y(!O(e.htmlContent),"Can't edit rich text node when htmlContent variable is assigned"),y(!O(e.textContent),"Can't edit rich text node when textContent variable is assigned");let _n=()=>{let Z=this.getRichTextNode();y(Z,"RichTextNode not found");let R=Z.getNodeInlineCodeStylePreset(Q.tree)??yr(Q.tree)??new mr;return hr(Q,R),Z.setNodeInlineCodeStylePreset(R),R.id},Mn=nr(e.html,{plugins:[w(),N({"Mod-z":r(An,Ol),"Mod-Shift-z":b,"Shift-Enter":ni,"Mod-b":Wo(de.marks.bold),"Mod-i":Wo(de.marks.italic),"Shift-Tab":F(de.nodes.listItem),Tab:r(Se(de.nodes.listItem),()=>!0),Backspace:r(An,ri),Escape:Al,Enter:Bl,"Mod-Shift-c":Wo(de.marks.inlineCode,{get inlineCodeStylePreset(){return _n()}})}),N(t),a({color:vr.cmsRichTextDropCursor,width:ae.richTextDropCursor}),u(),li(),di({engine:this.engine,nodeId:this.nodeId,getRichTextNode:()=>this.getRichTextNode()}),h({rules:[l,c,new U(Hl,(Z,R,V,Ne)=>{let $e=Z.doc.resolve(V),we=$e.node(1),Bt=$e.before(1);if(!jo(we))return null;let re=Z.tr,ze="h"+(R.groups?.hashes?.length||1),ut=this.getRichTextNode();y(ut,"RichTextNode not found");let et=ut.getNodeTextStylePreset(Q.tree,ze)??Ho(Q.tree,ze)??Yo.createDefault(ze),ve=et.id;return Q.processWhenReady(()=>{Jo(Q,et),ut.setNodeTextStylePreset(et)}),Zo(we)||re.removeMark(Bt,Bt+we.nodeSize,de.marks.inlineStyles),re.delete(V,Ne),re.setNodeMarkup(Bt,de.nodes.textBlock,{...we.attrs,blockStyles:ve?{}:we.attrs.blockStyles,inlineStyles:ve?{}:we.attrs.inlineStyles,textStylePreset:ve,tag:ze}),re}),ii,ai]}),...ei({markType:de.marks.inlineCode,attrs:{get inlineCodeStylePreset(){return _n()}}})]}),Rn,Pe=new d(null,{state:Mn,dispatchTransaction:Q.wrapHandler(Z=>{let R=this.getRichTextNode();y(R,"Node should not be null");let V=Pe.state.apply(Z);if(Pe.updateState(V),V=Cr(V,Pe,R),Rn!==V.doc){let Ne=or(V.doc);R.html!==Ne&&(this.updateNodeWithBreakpointAwareness(R,Ne),Ur(R,Pe)),Rn=V.doc}})});return{controls:{handleOnFocus(){Pe.setProps({decorations(){}})},handleOnBlur(){Pe.setProps({decorations(Z){let R=Z.selection;if(R.from!==R.to)return document.getSelection()?.removeAllRanges(),f.create(Z.doc,[s.inline(R.from,R.to,{class:"selection",nodeName:"mark"})])}})}},destroy:()=>Pe.destroy(),state:Mn,view:Pe}}updateNodeWithBreakpointAwareness(e,t){let{tree:r}=this.engine,{breakpointNode:i}=this.engine.stores.canvasStore;if(!Kn(i)||$n(i)){e.set({html:t});return}let s=dr(r,e,"html"),f=e.originalid||e.id;if(s){Fr(r,i,f,{html:t});return}(r.getNodeWithTrait(f,A)??e).set({html:t})}static supportsNode(e){return A(e)&&!e.htmlContent&&!e.textContent}};var me=class n extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;p(this,"controls");this.engine.beginUndoGroup(),jt().then(s=>{e.stores.toolStore.proseMirror??=s})}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.htmlContent;if(O(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return G(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"richtext",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!n.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=void 0}static supportsNode(e,t,r){if(!A(t)||!O(t.htmlContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,t.htmlContent,"richtext",i.collectionItemId):!1}};var ue=class n extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;this.engine.beginUndoGroup();let s=this.getRichTextNode();y(s,"Missing rich text node");let f=Yt(this.engine.tree,s);Oe.loadFonts(f).catch(H)}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.textContent;if(O(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return G(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"string",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!n.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=null}static supportsNode(e,t,r){if(!A(t)||!O(t.textContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,t.textContent,"string",i.collectionItemId):!1}};var Fe=class n extends j{update(){let o=this.engine,{canvasStore:e,treeStore:t,mouseStore:r,toolStore:i}=o.stores,s=e.breakpointNode;if(!s)return;if(r.isHoveringChrome){i.highlightedRenderId=void 0;return}let f=t.tree,a=r.canvasMousePosition,d=f.getNodeRendersAtPoint(s,a,!0),c=Ir(d,f),u=c.filter(h=>n.isSelectableNode(o,h.node,h.renderId)).at(-1);if(u){o.stores.toolStore.highlightedRenderId=u.renderId;return}let U=c.filter(h=>n.isUnexpectedlyUnselectableNode(o,h.node,h.renderId)).at(-1);if(U){i.highlightedRenderId=U.renderId;return}i.highlightedRenderId=void 0}static isSelectableNode(o,e,t){return Ue.supportsNode(o,e,t)||xe.supportsNode(o,e,t)||Ie.supportsNode(o,e,t)||pe.supportsNode(e)||me.supportsNode(o,e,t)||ue.supportsNode(o,e,t)}static isUnexpectedlyUnselectableNode(o,e,t){return n.isSelectableNode(o,e,t)?!1:cr(e)||fe(e)}};var hs=m($());var us="container_ci35ri5",gs="shockwaveMask_suurpvn",ys="shockwaveNodeHighlight_s1xlu29h";var fo=m(g()),ws=(0,hs.memo)(function(){let o=C(),{editableNodesHighlight:e}=o.stores.editableNodeHighlightStore.useState();return e?(0,fo.jsx)(q.div,{className:W(us,gs),initial:{"--radius":`${e.minRadius}px`},animate:{"--radius":`${e.maxRadius}px`},transition:{duration:e.animationDuration/1e3,ease:"easeOut"},style:{top:e.minY,height:e.maxY-e.minY,"--x":`${e.originX}px`,"--y":`${e.originY}px`,"--gradient-size":`${e.gradientSize}px`},children:(0,fo.jsx)("div",{style:{position:"absolute",top:-e.minY},children:e.highlights.map(t=>(0,fo.jsx)("div",{className:ys,style:{width:t.width,height:t.height,transform:t.transform,transformOrigin:"top left"}},t.renderId))})},e.animationId):null});var Cs="hudContainer_h1czcor4";var Xe=m($());var Us="popover_p6dts5z",xs="popoverWithModalInFront_pcmqzkm";var po="nodeHighlight_nbqylm8",Is="visuallyHidden_v1pcr3uc",Fs="pointerCursor_p1mivvux",bs="textCursor_t42x8tu",Ss="notAllowedCursor_n1atul0u",vs="background_b1i0g06w";var Es=m($()),Ps=m(g()),te=(0,Es.forwardRef)(function({tree:o,node:e,renderId:t,style:r,...i},s){let f=o.getRect(e,void 0,void 0,void 0,t),a=o.transformMatrixToNode(e,void 0,void 0,t);return(0,Ps.jsx)("div",{...i,ref:s,style:{position:"absolute",width:f.width,height:f.height,transformOrigin:"top left",transform:a.toString(),...r}})});var Y=m(g()),Ft=[];Object.freeze(Ft);var ec=["bottom","top","right","left"],tc={x:ae.inputSpacing,y:ae.inputSpacing};function Ns({tool:n}){let[o,e]=(0,Xe.useState)(null),t=C(),r=t.stores.modalStore.useState(l=>l.active.type!=="None"),[i,s]=(0,Xe.useState)(!1);!i&&r&&s(!0);let{tree:f}=t.stores.treeStore.useState(),a=f.getNodeWithTrait(n.nodeId,Jn),d=(0,Xe.useMemo)(()=>{let l=f;return n.getEditableControls()},[n,f]);function c(){t.exitTool()}if((0,Xe.useLayoutEffect)(()=>()=>{t.stores.modalStore.active.type!=="None"&&t.stores.modalStore.dismissAll()},[]),!(!a||!d||d.length===0))return(0,Y.jsx)(te,{tree:f,node:a,ref:e,renderId:n.renderId,className:po,children:(0,Y.jsx)(Wt,{anchor:o,alignSelf:"center",attachTo:ec,offset:tc,onClose:c,showArrow:!0,arrow:{anchor:o,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,themeOverrideMode:"darkOnDarkModal",className:W(Us,r&&xs),focusTrapEnabled:!r,animateAppear:!i,zIndex:21,children:(0,Y.jsx)(Ji,{displayDivider:!0,title:oc(a),onClose:c,children:(0,Y.jsx)(k,{gap:0,paddingTop:ae.inputSpacing,paddingBottom:ae.inputSpacing,paddingLeft:ae.panelPadding,paddingRight:ae.panelPadding,children:d.map(l=>{if(l.type==="component")switch(l.controlDescription.type){case"string":return y(l.reducedControlProp.type==="string"),(0,Y.jsx)(xt,{nodeIds:Ft,controlKey:l.controlKey,control:l.controlDescription,controlProp:l.reducedControlProp,onChange:(F,E)=>{y(l.controlProp.type==="string");let b=E(l.controlProp);Be(b,l.controlProp)||(a.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())}},l.controlKey);case"richtext":return y(l.reducedControlProp.type==="richtext"),(0,Y.jsx)($o,{title:l.controlDescription.title??"Unknown",children:(0,Y.jsx)(T,{title:"Edit Content",className:en,onClick:()=>{t.stores.modalStore.set({type:"RichTextEditor",controlKey:l.controlKey,nodeId:n.nodeId,source:"on_page_hud"})}})},l.controlKey);case"image":case"responsiveimage":return y(l.reducedControlProp.type==="image"||l.reducedControlProp.type==="responsiveimage"),(0,Y.jsx)(on,{nodeIds:Ft,controlKey:l.controlKey,control:l.controlDescription,controlProp:l.reducedControlProp,onChange:(F,E)=>{y(w.type==="image");let b=E(w);Be(b,w)||(a.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())},onUpload:async(F,E)=>{let b=await F;if(!b)return;y(l.controlProp.type==="image");let Se=sa(l.controlProp,b);a.setControlProp(E,Se),t.stores.projectStore.commitTreeAndSend()}},l.controlKey);case"date":return y(l.reducedControlProp.type==="date"),(0,Y.jsx)(tn,{controlKey:l.controlKey,control:l.controlDescription,controlProp:l.reducedControlProp,onChange:(F,E)=>{y(F.type==="date"),!Be(F,w)&&(a.setControlProp(E,F),t.stores.projectStore.commitTreeAndSend())}},l.controlKey);default:Vo(l.controlDescription)}let{variableInfo:u}=l,{controlProp:w,controlDescription:U,collectionItemNode:h,variableDefinition:N,reducedControlProp:x}=u;switch(w.type){case"string":return y(U.type==="string"),y(x.type==="string"),(0,Y.jsx)(xt,{nodeIds:Ft,controlKey:N.id,control:U,controlProp:x,onChange:(F,E)=>{y(w.type==="string");let b=E(w);Be(b,w)||(h.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())}},l.controlKey);case"richtext":return y(U.type==="richtext"),y(x.type==="richtext"),(0,Y.jsx)($o,{title:U.title||Xn(N.id),children:(0,Y.jsx)(T,{title:"Edit Content",className:en,onClick:()=>{t.stores.modalStore.set({type:"RichTextEditor",controlKey:N.id,nodeId:h.id,source:"on_page_hud"})}})},l.controlKey);case"image":return y(U.type==="responsiveimage"),y(x.type==="responsiveimage"),(0,Y.jsx)(on,{nodeIds:Ft,controlKey:N.id,control:U,controlProp:x,onChange:(F,E)=>{y(w.type==="image");let b=E(w);Be(b,w)||(h.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())},onUpload:async(F,E)=>{let b=await F;b&&(h.setControlProp(E,{type:"image",value:b}),t.stores.projectStore.commitTreeAndSend())}},l.controlKey);case"date":return y(U.type==="date"),y(x.type==="date"),(0,Y.jsx)(tn,{controlKey:N.id,control:U,controlProp:x,onChange:(F,E)=>{y(F.type==="date"),y(w.type==="date"),!Be(F,w)&&(h.setControlProp(E,F),t.stores.projectStore.commitTreeAndSend())}},l.controlKey);case"link":return y(U.type==="link"),y(x.type==="link"),(0,Y.jsx)(Fa,{controlKey:N.id,control:U,controlProp:x,onChange:(F,E)=>{y(w.type==="link");let b=E(w);Be(b,w)||(h.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())}},l.controlKey);default:Vo(w)}})})})})})}function oc(n){let o=L.reactComponentForIdentifier(n.codeComponentIdentifier);return o?o.name:"Component"}var bt=m($());var In=m(g());function Os({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),r=t.tree,i=(0,bt.useRef)(null),s=t.stores.canvasStore.webPageNode,f=r.getNodeWithTrait(o,A);if(nc(i,()=>{t.exitTool()}),(0,bt.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"})),!!f&&s)return(0,In.jsx)(te,{ref:i,tree:r,node:f,renderId:e,children:(0,In.jsx)(Qi,{tool:n,scopeNode:s,node:f,renderId:e,backdropEnabled:!0})})}function nc(n,o){(0,bt.useEffect)(()=>{function e(t){n.current&&!n.current.contains(t.target)&&o()}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[n,o])}var Fn=m($());var Ze=m(g());function Bs(){let n=C(),{tree:o}=n.stores.treeStore.useState(),{highlightedRenderId:e}=n.stores.toolStore.useState(),t=n.stores.mouseStore.useState(c=>c.lastUpdateType==="scroll"),r=Ut(e),i=o.get(r),s=rc(i,e),f=(0,Fn.useCallback)(()=>{n.stores.editableNodeHighlightStore.highlight(n,{type:"clickOnVoid"})},[]),a=!!i&&!!e&&Fe.isUnexpectedlyUnselectableNode(n,i,e),d=!!i&&!!e&&(pe.supportsNode(i)||me.supportsNode(n,i,e)||ue.supportsNode(n,i,e));return(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)("div",{className:W(vs,a&&Ss),onClick:f}),i&&e&&!a&&(0,Ze.jsx)(te,{tree:o,node:i,renderId:e,className:W(po,t&&Is,d?bs:Fs),onClick:s})]})}function rc(n,o){let e=C();return(0,Fn.useCallback)(()=>{if(!(!n||!o)){if(Ue.supportsNode(e,n,o))return e.startComponentInstanceEditTool(n.id,o);if(xe.supportsNode(e,n,o))return e.startDateVariableEditTool(n.id,o,"mouse");if(Ie.supportsNode(e,n,o))return e.startImageEditTool(n.id,o);if(pe.supportsNode(n))return e.startRichTextEditTool(n.id,o,"mouse");if(me.supportsNode(e,n,o))return e.startRichTextVariableEditTool(n.id,o,"mouse");if(ue.supportsNode(e,n,o))return e.startStringVariableEditTool(n.id,o,"mouse")}},[n,o])}var oe=m($());var As="popout_pqnmppj";var ce=m(g()),ac=["right","left"],sc={x:15,y:0};function _s({tool:n}){let{nodeId:o,renderId:e}=n,[t,r]=(0,oe.useState)(null),i=C(),{tree:s}=i.stores.treeStore.useState(),f=s.getNodeWithTrait(o,zt);function a(){i.exitTool()}if(f)return(0,ce.jsx)(te,{tree:s,node:f,renderId:e,ref:r,children:(0,ce.jsxs)(Wt,{anchor:t,alignSelf:"center",attachTo:ac,offset:sc,onClose:a,showArrow:!0,arrow:{anchor:t,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,themeOverrideMode:"darkOnDarkModal",children:[(0,ce.jsx)(Lr,{disableDivider:!0,onClose:a,children:(0,ce.jsx)(qr,{title:"Image"})}),(0,ce.jsx)("div",{className:As,children:ke(f.fillImage)?(0,ce.jsx)(lc,{node:f,dynamicValue:f.fillImage,renderId:e}):(0,ce.jsx)(fc,{node:f})})]})})}function lc({node:n,dynamicValue:o,renderId:e}){return y(O(o),"Expected variable reference"),(0,ce.jsx)(cc,{node:n,variableReference:o,renderId:e})}function cc({node:n,variableReference:o,renderId:e}){let t=C(),r=t.stores.treeStore.useState(c=>{let l=n.cache.getRenderInstance(e);return G(c.tree,c.sandboxCollectionData,o,"image",l?.collectionItemId)});y(r,"Variable info must exist");let{collectionItemNode:i,reducedControlProp:s,controlProp:f}=r;y(s.type==="responsiveimage","Expected reduced responsive image");let a=(0,oe.useCallback)(c=>{i.set(Ko({[o.id]:c(f)})),t.stores.projectStore.commitTreeAndSend()},[i,o,f]),d=(0,oe.useCallback)(()=>{i.set(Ko({[o.id]:{type:"image",value:void 0}})),t.stores.projectStore.commitTreeAndSend()},[i,o]);return(0,ce.jsx)(Zi,{controlProp:s,onChange:a,onRemove:d,maxExtraImages:0})}function fc({node:n}){let o=C(),e=(0,oe.useMemo)(()=>{let c={...Bi(),..._i()};return Ai(n,c),Mi(n,c),c},[n]),t=(0,oe.useCallback)(async c=>{let[l]=await c;l&&(Ii(n,l),o.stores.projectStore.commitTreeAndSend())},[n]),r=(0,oe.useCallback)(c=>{ie(n.fillImage)&&(n.set({fillImage:Ln(n.fillImage,c)}),o.stores.projectStore.commitTreeAndSend())},[n]),i=(0,oe.useCallback)(c=>{fr(n)&&(n.set({altAttribute:c}),o.stores.projectStore.commitTreeAndSend())},[n]),s=(0,oe.useCallback)(c=>{n.set({fillImageResize:c}),o.stores.projectStore.commitTreeAndSend()},[n]),f=(0,oe.useCallback)(c=>{n.set({fillImageTileSize:c}),o.stores.projectStore.commitTreeAndSend()},[n]),a=(0,oe.useCallback)((c,l)=>{n.set({fillImagePositionX:c,fillImagePositionY:l}),o.stores.projectStore.commitTreeAndSend()},[n]),d=(0,oe.useCallback)(()=>{n.set({fillImage:void 0}),o.stores.projectStore.commitTreeAndSend()},[n]);return(0,ce.jsx)(Vi,{...e,imageReferences:e.fillImages,altText:e.altAttribute,onChangeImages:t,onChangeAssetSize:r,onChangeAltText:i,onChangeImageResize:s,onChangeFillImageSize:f,onChangeImagePosition:a,onRemoveImage:d})}var Ms=m($());function st(n){let o=C(),{domLayoutUpdate:e,tree:t}=o.stores.treeStore.useState();return(0,Ms.useMemo)(()=>{let r=t.getNode(n);if(!r)return;let{breakpointNode:i}=o.stores.canvasStore;if(!i)return;let s=e;return dc(t,i,r)},[e,n,t])}function dc(n,o,e){let t=n.convertFrameToCanvas(e),r=n.getNodesInRect(o,t,!0),i=n.sortVisually(r),s=i.findIndex(l=>l.id===e.id);if(s===-1)return;let f=i.slice(s+1);if(f.length===0)return;let d=n.transformMatrixToNode(e).inverse(),c=`M ${-De},${-De} L ${-De},${t.height+De} L ${t.width+De},${t.height+De} L ${t.width+De},${-De} Z`;for(let l of f){let u=n.getRect(l),w=n.transformMatrixToNode(l),U=d.multiply(w),h=new DOMPoint(0,0).matrixTransform(U),N=new DOMPoint(u.width,0).matrixTransform(U),x=new DOMPoint(u.width,u.height).matrixTransform(U),F=new DOMPoint(0,u.height).matrixTransform(U);c+=` L ${h.x},${h.y} L ${N.x},${N.y} L ${x.x},${x.y} L ${F.x},${F.y} L ${h.x},${h.y} Z`}return`path("${c}")`}var De=100;var bn=m(g());function Rs({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),{treeStore:r,canvasStore:i,toolStore:s}=t.stores,{tree:f}=r.useState(),a=st(o),d=f.getNodeWithTrait(o,A),c=i.webPageNode;return!d||!c||!s.proseMirrorView?null:(0,bn.jsx)(te,{tree:f,node:d,renderId:e,children:(0,bn.jsx)($i,{tool:n,scopeNode:c,node:d,renderId:e,editorView:s.proseMirrorView,zoom:1,handleOutsideClick:l=>{l.target===l.currentTarget&&t.exitTool()},style:{clipPath:a}})})}var Ds="validationBadge_v1r7rm12";var uo=m(g());function pc(n){return n.message}function mo({validationWarning:n}){if(!n)return null;let o=pc(n);return(0,uo.jsxs)("div",{className:Ds,children:[(0,uo.jsx)(Br,{width:10,height:10}),o]})}var St=m(g());function Ts({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),{treeStore:r,canvasStore:i,toolStore:s}=t.stores,{validationWarning:f}=t.stores.toolStore.useState(),{tree:a}=r.useState(),d=st(o),c=i.webPageNode,{proseMirror:l}=s.useState(),u=a.getNodeWithTrait(o,A);if(!u||!c||!l)return;function w(U){U.target===U.currentTarget&&t.exitTool()}return(0,St.jsxs)(te,{tree:a,node:u,renderId:e,children:[(0,St.jsx)(mo,{validationWarning:f}),(0,St.jsx)(ea,{tool:n,scopeNode:c,node:u,renderId:e,proseMirror:l,zoom:1,onClickOutside:w,hasValidationWarning:!!f,style:{clipPath:d}})]})}var vt=m(g());function Gs({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),{tree:r}=t.stores.treeStore.useState(),{validationWarning:i}=t.stores.toolStore.useState(),s=st(o),f=r.getNodeWithTrait(o,A),a=t.stores.canvasStore.webPageNode;return!a||!f?null:(0,vt.jsxs)(te,{tree:r,node:f,renderId:e,children:[(0,vt.jsx)(mo,{validationWarning:i}),(0,vt.jsx)(ta,{tool:n,scopeNode:a,node:f,renderId:e,zoom:1,onClickOutside:d=>{d.target===d.currentTarget&&t.exitTool()},hasValidationWarning:!!i,style:{clipPath:s}})]})}var se=m(g());function zs(){let{treeStore:n,sandboxStore:o}=C().stores,{canvasHeight:e}=o.useState(),t=n.useState(r=>r.tree.getPresetsListNode());return(0,se.jsxs)("div",{className:Cs,style:{height:e??"initial"},children:[(0,se.jsx)(ws,{}),(0,se.jsx)(mc,{}),(0,se.jsx)(Pi,{presetsListNode:t})]})}function mc(){let{toolStore:n,canvasStore:o,projectStore:e}=C().stores,{tool:t}=n.useState(),{modalState:r}=o.useState(),{hasPermanentlyFailed:i}=e.useState();if(!i&&r.type==="hidden"){if(t instanceof Fe)return(0,se.jsx)(Bs,{});if(t instanceof Ie)return(0,se.jsx)(_s,{tool:t});if(t instanceof pe)return(0,se.jsx)(Rs,{tool:t});if(t instanceof me)return(0,se.jsx)(Ts,{tool:t});if(t instanceof ue)return(0,se.jsx)(Gs,{tool:t});if(t instanceof xe)return(0,se.jsx)(Os,{tool:t});if(t instanceof Ue)return(0,se.jsx)(Ns,{tool:t})}}var be=m(g());function qs(){it();let n=C(),{isHidden:o}=n.stores.canvasStore.useState();return(0,go.useEffect)(()=>{let e=({data:t})=>{if(Ae(t)&&t.apiVersion===1){let{type:r,position:i}=t;r==="showCanvas"&&Ae(i)&&qn(i.top)&&(window.scrollTo({behavior:"instant",top:i.top}),setTimeout(()=>{n.stores.canvasStore.isHidden=!1,n.startHighlightTool(),n.stores.editableNodeHighlightStore.highlight(n,{type:"start"})},0))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,go.useEffect)(()=>{let{sandboxStore:e}=n.stores;o?e.hide():e.show()},[o]),uc(o),(0,Ls.createPortal)((0,be.jsx)(qt,{mode:"onPageEditing",children:(0,be.jsxs)("div",{className:W(o&&Pa),children:[(0,be.jsx)(zs,{}),(0,be.jsxs)("div",{className:Na,[rn]:"true",children:[(0,be.jsx)(ms,{}),(0,be.jsx)(Ta,{}),(0,be.jsx)(Zr,{padding:80}),(0,be.jsx)(oa,{ref:n.stores.projectStore.filePickerRef})]})]})}),document.body)}function uc(n){let o=C();(0,go.useEffect)(()=>{if(n)return;let e=new Ki;e.set("CommandOrControl+Z",o.undo.bind(o),"undo"),e.set("CommandOrControl+Shift+Z",o.redo.bind(o),"redo");function t(r){if(Jt())return;let i=e.get(r);i&&(i.action(r),r.preventDefault(),r.stopPropagation())}return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[n])}function X(n){return window.editorBarFeatures[n]===!0}async function yo({awaitOnBeginSizeMeasuring:n=!0,onAbleToDraw:o,padding:e=0,ref:t}){let r=({width:a,height:d,padding:c=0})=>{let l=`calc(50% - ${d/2+c}px)`,u="0%",w=`calc(50% - ${d/2+c}px)`,U=`calc(100% - ${a+c*2}px)`;return`inset(${l} ${u} ${w} ${U})`},i=t;if(!i)return;window.parent.postMessage({apiVersion:1,type:"beginSizeMeasuring"},"*"),n&&await Ws(document.body),o&&(o(),await Ws(i));let s=i.getBoundingClientRect(),f=r({width:Math.ceil(s.width),height:Math.ceil(s.height),padding:e});window.parent.postMessage({apiVersion:1,type:"updateStyle",clipPath:f},"*")}async function Ws(n){let o=n.offsetWidth,e=n.offsetHeight,t=5e3,r=100;return new Promise(i=>{let s=window.setTimeout(()=>{a.disconnect(),i()},t),f=Wn(()=>{clearTimeout(s),a.disconnect(),i()},r),a=new ResizeObserver(()=>{(n.offsetWidth!==o||n.offsetHeight!==e)&&f()});a.observe(n)})}var ho=class extends S{constructor(e){super();this.getAccess=e;p(this,"_navigationState","Initializing");p(this,"_isMenuOpen",!localStorage.getItem(sn));p(this,"isMouseHoveringMenu",!1);p(this,"layoutRef");this.isMenuOpen&&this.scheduleMenuAutoClose()}get navigationState(){return this._navigationState}get isMenuOpen(){return this._isMenuOpen}registerLayoutRef(e){this.layoutRef=e,yo({ref:e,padding:30})}async navigate(e){e!==this._navigationState&&(!X("editorBarOnPageEditing")&&this.layoutRef?await yo({awaitOnBeginSizeMeasuring:!1,ref:this.layoutRef,onAbleToDraw:()=>{this._navigationState=e},padding:30}):this._navigationState=e)}async setMenuOpen(e){if(v(this.layoutRef,"Must registerLayoutRef before calling OnPageNavigationStore.navigate"),e&&this.navigationState==="SelectAppPreference"&&Vs()){let t=this.getAccess();t&&(this._navigationState=Sn(t))}await yo({awaitOnBeginSizeMeasuring:!1,ref:this.layoutRef,onAbleToDraw:()=>{this._isMenuOpen=e},padding:e?30:0})}async toggleMenuOpen(){await this.setMenuOpen(!this.isMenuOpen)}scheduleMenuAutoClose(){setTimeout(()=>{localStorage.setItem(sn,"true"),this.isMouseHoveringMenu||this.setMenuOpen(!1)},2e3)}};function Sn(n){switch(n.status){case"no-auth":return"Guest";case"success":return X("editorBarOnPageEditing")?"Canvas":Vs()?"Menu":"SelectAppPreference";case"unknown":return"CookiePrompt";case"error":return"Error";case"no-access":return"NoAccess";case"no-permission":return"NoPermission";default:ot(n)}}function Vs(){let n=localStorage.getItem(Re);return n==="browser"||n==="app"}var Ks=m($());function Xs(){(0,Ks.useEffect)(()=>{let n=o=>{if(!Ae(o.data))return;let{apiVersion:e,type:t}=o.data;e===1&&t==="enterOnPageEditing"&&K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-enter-on-page-editing"})};return window.addEventListener("message",n),()=>window.removeEventListener("message",n)},[])}var Je=m($());var Zs="wrapper_w1wtsf9k";var js="button_blajnuz",Ys="open_o1r4uh58",Hs="logo_lbr5chv";var ft=m(g());function Te({width:n=10,height:o=10,className:e}){return(0,ft.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:o,fill:"none",className:e,"aria-hidden":"true",children:(0,ft.jsxs)("g",{transform:"translate(2 2)",children:[(0,ft.jsx)("path",{d:"M 0 0 L 6 6",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),(0,ft.jsx)("path",{d:"M 0 6 L 6 0",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}var wo=m(g());function Js({open:n,hidden:o,onClick:e}){return(0,wo.jsx)(k,{className:J(js,n&&Ys),direction:"row",alignItems:"center",justifyContent:"center",style:{display:o?"none":void 0},onClick:e,role:"button","aria-label":`${n?"Close":"Open"} Framer Menu`,children:n?(0,wo.jsx)(Te,{}):(0,wo.jsx)(Lt,{className:Hs,height:16,"aria-hidden":"true"})})}var Co="container_c1amlb55",Qs="textContainer_t1noknjc",$s="title_t14vtnbc",el="subtitle_swpufyq",kt="button_b9jl8lf",Uo="editorBarButtonPrimary_eptse9g",tl="item_i187n6fv",ol="menuRowText_mirdjeq",nl="divider_djjgtbz",dt="iconSquare_ixgjdid",Et="buttonsContainer_b1qnbldr";var _=m(g());function Pt({children:n,onClick:o}){return(0,_.jsx)("button",{type:"button",className:tl,onClick:o,children:(0,_.jsx)("span",{className:ol,children:n})})}function je({children:n,onClick:o,disabled:e,layoutId:t,duration:r,className:i}){return(0,_.jsx)(q.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,_.jsx)(T,{type:"button",className:J(kt,i),onClick:o,enabled:!e,children:n})})}function Ee({logo:n,title:o,subtitle:e,buttons:t,showLearnMoreAndHideEditorBarButtons:r,customClassNames:i}){let{navigationStore:s}=C().stores,f=()=>{window.open("https://www.framer.com/help/articles/page-edit","_blank"),s.setMenuOpen(!1)},a=()=>{K("editor_bar_interaction",{page:"editor-bar-menu",id:"editor-bar-hide"}),window.parent.postMessage({apiVersion:1,type:"editorBarHidden"},"*")};return(0,_.jsxs)(k,{className:J(Co,i?.container),justifyContent:"center",alignItems:"center",children:[(0,_.jsxs)(k,{className:J(Qs,i?.textContainer),gap:15,alignItems:"center",justifyContent:"center",children:[n,(0,_.jsxs)(k,{gap:5,alignItems:"center",justifyContent:"center",children:[(0,_.jsx)(q.span,{layout:!0,className:J($s,i?.title),children:o}),(0,_.jsx)(q.p,{layout:!0,className:J(el,i?.subtitle),children:e})]})]}),t?(0,_.jsx)(k,{className:J(Et,i?.buttonsContainer),gap:10,children:t}):null,r?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("hr",{className:J(nl,i?.divider)}),(0,_.jsxs)(k,{className:J(Et,i?.buttonsContainer),gap:2,children:[(0,_.jsxs)(Pt,{onClick:f,children:[(0,_.jsx)(k,{className:J(dt,i?.iconSquare),children:(0,_.jsx)(Ar,{})}),"Learn More"]}),(0,_.jsxs)(Pt,{onClick:a,children:[(0,_.jsx)(k,{className:J(dt,i?.iconSquare),children:(0,_.jsx)(Te,{})}),"Hide Button"]})]})]}):null]})}var ge="https://app.framerstatic.com/framer-logo-blue-23OMXQLR.png";var rl="backdrop_bzafg2a",il="container_cnhgigm",al="textContainer_t1ookr3o",sl="title_tyol4w7",ll="subtitle_s7fryoi",cl="button_by9jupw",fl="buttonsContainer_b18g1n4a",dl="closeModal_c1gc3a0q";var ne=m(g());function Cc({children:n,onClick:o,disabled:e,layoutId:t,duration:r}){return(0,ne.jsx)(q.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,ne.jsx)(T,{type:"button",className:cl,onClick:o,enabled:!e,children:n})})}function pt({logo:n,title:o,subtitle:e,buttons:t,showLearnMoreButton:r}){let i=()=>{window.open("https://www.framer.com/help/articles/on-page-editing","_blank")},s=()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*"),window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*")};return(0,ne.jsx)(k,{className:rl,onClick:s,children:(0,ne.jsxs)(k,{className:il,justifyContent:"center",alignItems:"center",onClick:f=>f.stopPropagation(),children:[(0,ne.jsx)(k,{onClick:s,className:dl,children:(0,ne.jsx)(Te,{})}),(0,ne.jsxs)(k,{className:al,gap:15,alignItems:"center",justifyContent:"center",children:[n,(0,ne.jsxs)(k,{gap:5,alignItems:"center",justifyContent:"center",children:[(0,ne.jsx)(q.span,{layout:!0,className:sl,children:o}),(0,ne.jsx)(q.p,{layout:!0,className:ll,children:e})]})]}),t||r?(0,ne.jsxs)(k,{className:fl,gap:10,children:[r?(0,ne.jsx)(Cc,{onClick:i,children:"Learn More"}):null,t||null]}):null]})})}var Ye=m(g());function pl(){let{stores:{accessStore:n}}=C(),o=X("editorBarOnPageEditing");async function e(){K("editor_bar_interaction",{page:"editor-bar-cookie-prompt",id:"editor-bar-allow-cookies"});try{await document.requestStorageAccess()}finally{await n.refresh()}}return o?(0,Ye.jsx)(pt,{logo:(0,Ye.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Continuing may require granting permissions in a browser dialog.",buttons:(0,Ye.jsx)(T,{className:W(kt,Uo),onClick:e,variant:"primary",children:"Continue"}),showLearnMoreButton:!0}):(0,Ye.jsx)(Ee,{logo:(0,Ye.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:"Page Edit",subtitle:"You need to grant additional permissions to edit the site",buttons:(0,Ye.jsx)(T,{className:kt,onClick:e,children:"Grant Permissions"}),showLearnMoreAndHideEditorBarButtons:!0})}var vn="loginButtonLoading_l4nhz4u";var ye=m(g());function ml(){let{stores:{loginStore:n}}=C(),{isLoginInProgress:o}=n.useState(),e=X("editorBarOnPageEditing");async function t(){K("editor_bar_interaction",{page:"editor-bar-guest-page",id:"editor-bar-login"}),await n.login()}return e?(0,ye.jsx)(pt,{logo:(0,ye.jsx)("img",{decoding:"async",width:36,height:36,src:ge,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Edit the page directly in the browser, without opening the app.",buttons:(0,ye.jsx)(je,{onClick:t,disabled:o,className:Uo,children:o?(0,ye.jsx)("div",{className:vn,children:(0,ye.jsx)(nn,{})}):"Continue"}),showLearnMoreButton:!0}):(0,ye.jsx)(Ee,{logo:(0,ye.jsx)("img",{decoding:"async",width:36,height:36,src:ge,alt:"Framer Logo"}),title:"Page Edit",subtitle:"Edit pages in one click",buttons:(0,ye.jsx)(je,{onClick:t,disabled:o,children:o?(0,ye.jsx)("div",{className:vn,children:(0,ye.jsx)(nn,{})}):"Continue"}),showLearnMoreAndHideEditorBarButtons:!0})}var Nt=m(g()),ul="Page Edit",gl="To edit, ask the site owner for access to the project",yl="To edit, ask the site owner for content editing permissions";function kn({reason:n}){return X("editorBarOnPageEditing")?(0,Nt.jsx)(pt,{logo:(0,Nt.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:ul,subtitle:n==="no-permission"?yl:gl,showLearnMoreButton:!0}):(0,Nt.jsx)(Ee,{logo:(0,Nt.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:ul,subtitle:n==="no-permission"?yl:gl,showLearnMoreAndHideEditorBarButtons:!0})}var En=m(g());function hl(n){return(0,En.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"14",fill:"none","aria-hidden":"true",...n,children:(0,En.jsx)("path",{d:"M4.33 5.33H0v4.34L4.33 14V9.67h4.34ZM0 1h8.67v4.33H4.33Z",fill:"currentColor"})})}var wl="container_cs4bcfd",Cl="containerWithOnPageEditing_ctwsnmx",Ul="containerWithoutOnPageEditing_cauv9zl";var he=m(g());function xl(){let n=localStorage.getItem(Re)==="app",{stores:{accessStore:o,navigationStore:e,activeRouteStore:t}}=C(),{canEditContent:r}=o.useState();function i(){K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-open-project"}),ao({activeRouteStore:t,accessStore:o}),e.setMenuOpen(!1)}let s=()=>{K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-hide"}),window.parent.postMessage({apiVersion:1,type:"editorBarHidden"},"*")};return(0,he.jsx)(k,{className:W(Co,wl,X("editorBarOnPageEditing")?Cl:Ul),justifyContent:"center",alignItems:"center",children:(0,he.jsxs)(k,{className:Et,gap:2,children:[(0,he.jsxs)(Pt,{onClick:i,children:[(0,he.jsx)(k,{className:dt,children:n?(0,he.jsx)(hl,{}):(0,he.jsx)(Nr,{"aria-title":"Open in New Tab"})}),r?"Edit Page":"View Page"]}),(0,he.jsxs)(Pt,{onClick:s,children:[(0,he.jsx)(k,{className:dt,children:(0,he.jsx)(Te,{})}),"Hide"]})]})})}var Ot=m($());var Il="checkMarkContainer_c1den3f4",Pn="container_c19h5h6d",Fl="subtitle_s1n2m10t";var z=m(g()),Fc=()=>(0,z.jsx)(q.div,{layout:!0,className:Il,children:(0,z.jsx)(Er,{})});function bl(){let{stores:{navigationStore:n}}=C(),[o,e]=(0,Ot.useState)(null),t=.4,r=(0,Ot.useCallback)(s=>{K("editor_bar_interaction",{page:"editor-bar-select-app-preference",id:s==="browser"?"editor-bar-select-app-preference-browser":"editor-bar-select-app-preference-app"}),localStorage.setItem(Re,s),e(s)},[]),i=(0,Ot.useCallback)(()=>{n.setMenuOpen(!1)},[]);return(0,z.jsx)(nt,{mode:"wait",children:(0,z.jsx)(q.div,{layoutId:"preference-container",transition:{duration:t,type:"spring",bounce:.2,delay:0},children:o?(0,z.jsx)(Ee,{logo:(0,z.jsx)(Fc,{}),title:"Preference Saved",subtitle:`From now on, the Edit Page button will open the ${o}`,buttons:(0,z.jsx)(je,{layoutId:"preference-buttons",duration:t,onClick:i,children:"Dismiss"}),customClassNames:{container:Pn}}):(0,z.jsx)(Ee,{logo:(0,z.jsx)(q.img,{layout:!0,decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:"Page Edit",subtitle:(0,z.jsxs)(z.Fragment,{children:["Do you prefer to edit your sites in the"," ",(0,z.jsx)("a",{href:"https://www.framer.com/downloads/",target:"_blank",children:"Framer App"})," ","or in the web browser?"]}),buttons:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(je,{layoutId:"preference-buttons",duration:t,onClick:()=>r("app"),children:"Framer App"}),(0,z.jsx)(je,{onClick:()=>r("browser"),children:"Web Browser"})]}),customClassNames:{container:Pn,subtitle:Fl}})},o?"saved":"select")})}var He=m(g());function Nn(){let{stores:{accessStore:n,navigationStore:o}}=C(),{access:e}=n.useState(),{navigationState:t}=o.useState();switch(t){case"Guest":return(0,He.jsx)(ml,{});case"CookiePrompt":return(0,He.jsx)(pl,{});case"Menu":return v(e.status==="success"),(0,He.jsx)(xl,{});case"SelectAppPreference":return(0,He.jsx)(bl,{});case"NoAccess":return(0,He.jsx)(kn,{reason:"no-access"});case"NoPermission":return(0,He.jsx)(kn,{reason:"no-permission"});case"Canvas":case"Error":case"Initializing":return null;default:ot(t)}}var le=m(g());function Sc({children:n,open:o}){return(0,le.jsx)(nt,{children:o&&(0,le.jsx)(q.div,{initial:{marginRight:-4,opacity:0},animate:{marginRight:0,opacity:1},exit:{marginRight:-4,opacity:0},children:n})})}function Sl(){let n=C(),{navigationStore:o,accessStore:e,sandboxStore:t,activeRouteStore:r}=n.stores,{shouldRenderOnPageCanvas:i}=e.useState(),{isMenuOpen:s,navigationState:f}=o.useState(),a=(0,Je.useRef)(null),d=X("editorBarOnPageEditing"),c=_e(()=>r.webPageNodeId,[],[r]);(0,Je.useEffect)(()=>{!d||!c||t.waitForInitialLoad(c).then(()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*")}).catch(H)},[t,d,c]),(0,Je.useEffect)(()=>{f!=="Initializing"&&f!=="Error"&&window.parent.postMessage({apiVersion:1,type:"accessResult",data:{status:"success"}},"*")},[f]),(0,Je.useEffect)(()=>{n.performanceTracker.reportEditorBarReady()}),Xs(),(0,Je.useEffect)(()=>{d||a.current&&o.registerLayoutRef(a.current)},[d]);let l=()=>{o.isMouseHoveringMenu=!0},u=()=>{o.isMouseHoveringMenu=!1},w=async()=>{await o.toggleMenuOpen()};return d?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Nn,{}),i&&(0,le.jsx)(qs,{})]}):(0,le.jsxs)(k,{direction:"row",alignItems:"center",gap:10,ref:a,className:Zs,onMouseEnter:l,onMouseLeave:u,role:"presentation",children:[(0,le.jsx)(Sc,{open:s,children:(0,le.jsx)(Nn,{})}),(0,le.jsx)(Js,{hidden:f==="Initializing"||f==="Error",open:s,onClick:w})]})}var Io=class extends S{constructor(e,t,r,i){super();this.navigationStore=e;this.projectStore=t;this.hostnameStore=r;this.siteId=i;p(this,"_access")}get access(){return y(this._access,"Access not initialized"),this._access}get projectId(){return vl(this.access)}get canEditContent(){let e=this.access;return e.status!=="success"?!1:e.data.permissions?.canEditContent==="on"}get shouldRenderOnPageCanvas(){return X("editorBarOnPageEditing")&&an()&&this.canEditContent}async set(e){this._access=e;let t=Sn(e);if(await this.navigationStore.navigate(t),this.shouldRenderOnPageCanvas){let r=vl(e);e.userId&&r&&(this.projectStore.loadProject(e.userId,r),this.hostnameStore.loadHostnames(r).catch(H))}gr.setUserId(e.userId??"null")}async refresh(){let e=await Ua(this.siteId);await this.set(e)}},vc=/^(?<name>.+--)?(?<id>[a-z0-9]{20})(?<hash>-[a-z0-9]+)?$/iu;function vl(n){if(n.status==="success")return vc.exec(n.data.projectSlug)?.groups?.id}var Fo=class extends S{constructor(e){super();this.editableNodeHighlightStore=e;p(this,"localeId",rr);p(this,"_collectionItemNodeId");p(this,"_webPageNodeId");let t=({data:r})=>{if(Ae(r)&&r.apiVersion===1){let{type:i,nodeIds:s}=r;if(i==="updateNodeIds"&&Ae(s)&&ie(s.webPageNodeId)){let{webPageNodeId:f,collectionItemNodeId:a}=s;this._webPageNodeId=f,this._collectionItemNodeId=ie(a)?a:void 0,this.editableNodeHighlightStore.onChangeRoute()}}};window.addEventListener("message",t),window.parent.postMessage({apiVersion:1,type:"initializeComponent",component:"OnPageActiveRouteStore"},"*")}get collectionItemNodeId(){return this._collectionItemNodeId}get webPageNodeId(){return this._webPageNodeId}get projectLinkNodeId(){return this._collectionItemNodeId??this._webPageNodeId}};var bo=class extends S{constructor(){super(...arguments);p(this,"_assets",[]);p(this,"_assetService");p(this,"assetMap",new Gn)}get assets(){return this._assets}get assetService(){return this._assetService}setAssetService(e){this._assetService=e,zn(e,t=>{t.assets&&(this._assets=t.assets,this.assetMap.set(t.assets),Oe.importCustomFonts(t.assets,Hn.isOn("customFontImprovements")))})}};var On={slug:!0,string:!0,richtext:!0,link:!0,image:!0,array:!0,multicollectionreference:!0,collectionreference:!0,file:!0,date:!0,number:!0,boolean:!0,enum:!0};async function kl(n){return Vr.post("/edit/notifications/page-edited",n)}var So=class extends S{constructor(e,t,r,i,s,f,a){super();this.accessStore=e;this.activeRouteStore=t;this.editableNodeHighlightStore=r;this.treeStore=i;this.projectStore=s;this.undoRedoManager=f;this.exitTool=a;p(this,"isHidden",!0);p(this,"_screenWidth",window.innerWidth);p(this,"_temporaryCollectionItemNodeId");p(this,"_modalState",{type:"hidden"});window.addEventListener("resize",()=>{this._screenWidth=window.innerWidth})}get screenWidth(){return this._screenWidth}get temporaryCollectionItemNodeId(){return this._temporaryCollectionItemNodeId}set temporaryCollectionItemNodeId(e){this._temporaryCollectionItemNodeId=e,this.editableNodeHighlightStore.onChangeRoute()}get modalState(){return this._modalState}get webPageNode(){let e=this.activeRouteStore.webPageNodeId,t=this.treeStore.tree.getNodeWithTrait(e,Yn);if(t?.loaded)return t.loaded;t?.load().catch(H)}get collectionItemNode(){return this.treeStore.tree.getNodeWithTrait(this.temporaryCollectionItemNodeId??this.activeRouteStore.collectionItemNodeId,We)??void 0}get collectionNode(){let e=this.collectionItemNode;if(e)return this.treeStore.tree.getNodeWithTrait(e.parentid,Tt)??void 0}get isCreatingCollectionItem(){return!!this.collectionItemNode?.privateToUserId}createTemporaryCollectionItem(){let e=this.collectionNode;if(!e)return;let t=this.accessStore.access?.userId;y(t,"User must be logged in");let r=e.getPrivateItemForUser(t);if(r)this.temporaryCollectionItemNodeId=r.id;else{let i=pr.create({isDraft:!0,privateToUserId:t});this.treeStore.tree.insertNode(i,e.id,0),this.temporaryCollectionItemNodeId=i.id;let s=new Date().toJSON();for(let f of e.variables)f.type==="date"&&i.setControlProp(f.id,{type:"date",value:s});this.projectStore.commitTreeAndSend()}}get breakpointNode(){let e=this.webPageNode?.getBreakpointValues(),t=Qn(e,this.screenWidth);return this.treeStore.tree.get(t)}get stylePresetBreakpointClassNames(){let e=this.treeStore.tree.getPresetsListNode(),t=Yi(e);return Hi(t,this.screenWidth)}async sendNotification(e){let t=this.accessStore.projectId;y(t,"Project ID must exist");let r=this.webPageNode;y(r,"Web page node must exist");let i=this.collectionItemNode,s;if(i){let f=this.collectionNode;y(f,"Collection item exists, so its parent collection must exist"),y(f.name,"Collection node must have a name"),s={notificationType:e,projectId:t,webPageNodeId:r.id,collectionItemNodeId:i.id,collectionItemTitle:kc(f,i),collectionTitle:f.name,pageType:"cms-detail"}}else s={notificationType:e,projectId:t,webPageNodeId:r.id,pageTitle:r.webMetadata?.title||$r(this.treeStore.tree,r),pageType:"static"};await kl(s)}discardTemporaryCollectionItem(){y(this.collectionItemNode,"Collection item node must exist"),y(this.collectionItemNode.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),this.treeStore.tree.remove(this.collectionItemNode.id),this.projectStore.commitTreeAndSend(),this.clearTemporaryItem(),this.exitFullscreen()}saveTemporaryCollectionItem(){y(this.collectionItemNode,"Collection item node must exist"),y(this.collectionItemNode.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),this.treeStore.tree.current(this.collectionItemNode)?.set({privateToUserId:void 0}),this.projectStore.commitTreeAndSend(),this.finishEditingWithChanges(this.collectionItemNode.id,!0)}handleFinishEditing(){if(this.exitTool(),!this.isCreatingCollectionItem){if(!this.treeStore.hasChanged()){this.handleDismissFinishEditing();return}let a=this.activeRouteStore.projectLinkNodeId;if(!a)return;this.finishEditingWithChanges(a,!1);return}let{collectionItemNode:e}=this,{collectionNode:t}=this;if(y(t&&e,"Collection node and collection item node must exist"),!e.hasData()){this.discardTemporaryCollectionItem();return}let r=Qt(t,e);Li(t,e,r)&&this.projectStore.commitTreeAndSend();let f=zi(this.treeStore.tree,t,e,r).flatMap(a=>{let d=a.type;return On[d]!==void 0?a.id:[]});f.length>0?this._modalState={type:"requiredFields",fieldIdsToShow:f}:this.saveTemporaryCollectionItem()}finishEditingWithChanges(e,t){this._modalState={type:"finishEditing",nodeId:e,isNewItem:t},K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-finish-editing-with-changes"});let r=t?"page-created":"page-edited";this.sendNotification(r).catch(H)}handleShowAllFields(){let e=this.collectionNode;y(e,"Collection node must exist");let r=Gi(this.collectionNode).flatMap(i=>{let s=i.type;return On[s]!==void 0?i.id:[]});this.exitTool(),this._modalState={type:"allFields",fieldIdsToShow:r}}handleDismissFinishEditing(){this.clearTemporaryItem(),this.undoRedoManager.clearUndoStack(),this.exitFullscreen()}exitFullscreen(){window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*"),this.isHidden=!0}resetModalState(){this._modalState={type:"hidden"}}clearTemporaryItem(){this.resetModalState(),this.temporaryCollectionItemNodeId=void 0}};function kc(n,o){let e=n.variables.find(Ve);if(e?.associatedStringVariable){let t=o.getControlProp(e.associatedStringVariable);if(t&&t.type==="string"&&ie(t.value)&&t.value.trim())return t.value.trim()}return"a new page"}var vo=class extends S{updateComponentLoader(o,e){L.setModuleRevision(e,0);for(let t of o)L.updateEntity(t.identifier,t)}};var Ec=0,mt,ko=class extends S{constructor(){super();p(this,"editableNodesHighlight");At(this,mt);window.addEventListener("resize",()=>{this.editableNodesHighlight&&(this.editableNodesHighlight=void 0)})}onChangeRoute(){this.editableNodesHighlight&&(this.editableNodesHighlight=void 0)}cleanupAnimationOnFinish(e){Le(this,mt)&&clearTimeout(Le(this,mt)),_t(this,mt,window.setTimeout(()=>{this.editableNodesHighlight=void 0},e+100))}highlight(e,{type:t}){let r=e.stores.canvasStore.breakpointNode;if(!r)return;let i=[],s={x:0,y:window.scrollY,width:window.innerWidth,height:window.innerHeight},f=1/0,a=-1/0,d=!1;for(let c of r.walk())for(let[l]of c.cache.iterateRenderInstances()){if(!Fe.isSelectableNode(e,c,l))continue;d=!0;let u=e.tree.convertFrameToCanvas(c,void 0,l);if(!Pc(s,u))continue;f=Math.min(f,u.y),a=Math.max(a,u.y+u.height);let w=e.tree.getRect(c,void 0,void 0,void 0,l),U=e.tree.transformMatrixToNode(c,void 0,void 0,l);i.push({renderId:l,width:w.width,height:w.height,transform:U.toString(),centerX:u.x+u.width/2,centerY:u.y+u.height/2})}if(i.length===0)ht({key:"editable-nodes-highlight-empty",type:"add",text:d?"Editable content is out of view, scroll to reveal it":"Content is not editable on this page",variant:"info"}),this.editableNodesHighlight=void 0;else{let c=t==="clickOnVoid",l=c?e.stores.mouseStore.windowMousePosition.x:s.width,u=c?e.stores.mouseStore.windowMousePosition.y:s.height/2,w=c?e.stores.mouseStore.canvasMousePosition.y:e.stores.mouseStore.scrollPosition.y,U=400,h=Math.max(l,window.innerWidth-l),N=Math.max(u,window.innerHeight-u),x=Math.sqrt(h**2+N**2)+U,F=Math.max(500,t==="clickOnVoid"?x:x*2),E=5,b=Math.max(0,Math.floor(f-E)),Se=Math.ceil(a+E),qo=Nc(i,x,l,w);this.editableNodesHighlight={animationId:`editable-nodes-highlight-${Ec++}`,minY:b,maxY:Se,originX:l,originY:u-b+s.y,highlights:i,minRadius:qo,maxRadius:x,gradientSize:U,animationDuration:F},this.cleanupAnimationOnFinish(F)}}};mt=new WeakMap;function Pc(n,o){return!(o.x>=gt.maxX(n)||gt.maxX(o)<=n.x||o.y>=gt.maxY(n)||gt.maxY(o)<=n.y)}function Nc(n,o,e,t){let r=1/0;for(let i of n){let s=Math.sqrt(i.width**2+i.height**2),f=Math.abs(i.centerX-e),a=Math.abs(i.centerY-t),d=Math.sqrt(f**2+a**2),c=Math.max(0,d-s/2);r=Math.min(r,c)}return Number.isFinite(r)&&r<o?r:0}var Eo=class extends xi{constructor(){super(...arguments);p(this,"hostnames")}get customHostnameString(){return this.hostnames?.find(e=>e.type==="custom")?.hostname}get defaultHostnameString(){return this.hostnames?.find(e=>e.type==="default")?.hostname}async loadHostnames(e){let{hostnames:t}=await Ui(e);this.hostnames=t}};var Po=class extends S{constructor(e){super();this.sandboxStore=e}async ensureModuleEvaluatedInSandbox(e){await(await this.sandboxStore.getModulesRuntime()).loadModule(e.value)}hasModuleForIdentifier(e){return!!L.componentForIdentifier(e.value)}};var No=class extends S{constructor(e){super();this.accessStore=e;p(this,"isLoginInProgress",!1)}login(){let e=window.open(`${Dt().login}?closeAfterSuccess=true`,"_blank");return e?this.startLoginWindowClosedPolling(e):Promise.resolve()}startLoginWindowClosedPolling(e){return this.isLoginInProgress=!0,new Promise(r=>{let i=setInterval(async()=>{e.closed&&(clearInterval(i),await this.accessStore.refresh(),this.isLoginInProgress=!1,r())},500)})}};var Oo=class extends S{constructor(){super();p(this,"_lastUpdateType",null);p(this,"_scrollPosition",qe(0,0));p(this,"_windowMousePosition",qe(0,0));p(this,"_canvasMousePosition",qe(0,0));p(this,"_isHoveringChrome",!1);let e=this.onMouseMove.bind(this);document.addEventListener("mousemove",e);let t=this.onScroll.bind(this);document.addEventListener("scroll",t)}get lastUpdateType(){return this._lastUpdateType}get scrollPosition(){return this._scrollPosition}get windowMousePosition(){return this._windowMousePosition}get canvasMousePosition(){return this._canvasMousePosition}get isHoveringChrome(){return this._isHoveringChrome}onScroll(){this._scrollPosition=qe(window.scrollX,window.scrollY),this._lastUpdateType="scroll",this.updateCanvasMousePosition()}onMouseMove(e){this._isHoveringChrome=ka(e.target),this._windowMousePosition=qe(e.clientX,e.clientY),this._lastUpdateType="mouseMove",this.updateCanvasMousePosition()}updateCanvasMousePosition(){this._canvasMousePosition=qe.add(this.windowMousePosition,this.scrollPosition)}};var El=m($());var Bo=class extends S{constructor(e,t){super();this.assetStore=e;this.treeStore=t;p(this,"_hasPermanentlyFailed",!1);p(this,"project");p(this,"projectPromise",new tt);p(this,"filePickerRef",(0,El.createRef)())}get hasPermanentlyFailed(){return this._hasPermanentlyFailed}getProject(){return this.projectPromise}get resourceLimits(){}get featureFlags(){}get projectLicenseType(){return"freeSite"}loadProject(e,t){it(),!this.project&&(this.project=new ba(this.treeStore.timeline,e,t),this.project.connect(),this.project.document.on("disconnect",this.onDisconnect,this),this.project.connection.on("disconnect",this.onDisconnect,this),this.project.document.on("update",r=>{this.treeStore.newTreeAfterRemoteUpdate(r)}),this.assetStore.setAssetService(this.project.assetService),this.projectPromise.resolve(this.project))}onDisconnect(e){bi(e)||(this._hasPermanentlyFailed=!0,e==="ClientNeedsUpdate"?ht({type:"add",variant:"warning",text:"A new version of Framer is available. Please reload the page to continue working.",key:"client-outdated",duration:1/0,icon:"warning",showCloseButton:"never"}):ht({type:"add",variant:"error",text:"Connection error: "+e,key:"connection-error",duration:1/0,icon:"error",showCloseButton:"never"}))}commitTreeAndSend(e=!0){y(this.project,"Project must be initialized"),y(!this.hasPermanentlyFailed,"Project is permanently failed");let t=this.treeStore.timeline.commitLocalTree();this.treeStore.newTreeAfterLocalUpdate(t,e),this.project.maybeSend()}};var Pl="iframe_icxp2h1";var Ao=class extends S{constructor(e,t,r,i){super();this.componentsStore=e;this.treeStore=t;this.performanceTracker=r;this.updateGenerator=i;p(this,"config",jr.onPageCanvas);p(this,"iframe");p(this,"remoteSandbox");p(this,"remoteControlsVisibility",new tt);p(this,"remoteModulesRuntime",new tt);p(this,"_canvasHeight");p(this,"webPageNodeIdToInitialLoadPromise",new Map);window.addEventListener("scroll",()=>{this.remoteSandbox?.scrollTo({behavior:"instant",top:window.scrollY})})}getControlsVisibility(){return this.remoteControlsVisibility}getModulesRuntime(){return this.remoteModulesRuntime}get canvasHeight(){return this._canvasHeight}loadSandbox(){it(),y(!this.iframe,"Sandbox already loaded");let e=document.createElement("iframe");e.src=this.config.url,e.allow=ji("canvas"),e.sandbox.add("allow-scripts","allow-same-origin"),e.tabIndex=-1,e.id="canvas_sandbox",e.className=Pl;let t=this.initializeSandbox.bind(this,e);e.addEventListener("load",t),this.iframe=e,this.hide(),document.body.append(e)}getInitialLoadPromise(e){let t=this.webPageNodeIdToInitialLoadPromise.get(e)??new tt;return this.webPageNodeIdToInitialLoadPromise.set(e,t),t}async waitForInitialLoad(e){this.performanceTracker.reportCanvasLoaderViewed(),await this.getInitialLoadPromise(e)}async initializeSandbox(e){let t=e.contentWindow;y(t,"Sandbox didn't load correctly");let r=new Yr(Me);r.setLocal(Me.channels.componentsStore,this.componentsStore),r.setLocal(Me.channels.sandboxStore,this),r.setLocal(Me.channels.treeStore,this.treeStore);let i=r.getRemote(Me.channels.sandbox),s=r.getRemote(Me.channels.controlsVisibility),f=r.getRemote(Me.channels.modulesRuntime);await r.connect({target:t,url:this.config.origin}),this.remoteSandbox=i,this.remoteControlsVisibility.resolve(s),this.remoteModulesRuntime.resolve(f)}onHeightChange(e){this._canvasHeight=e}onInitialLoadComplete(e){this.performanceTracker.reportCanvasReady(),this.getInitialLoadPromise(e).resolve()}update(){let e=this.remoteSandbox;if(!e)return;let t=this.updateGenerator.getUpdate();Rt(t)||e.update(t)}hide(){y(this.iframe,"Sandbox not loaded"),this.iframe.setAttribute("aria-hidden","true")}show(){y(this.iframe,"Sandbox not loaded"),this.iframe.removeAttribute("aria-hidden")}};var _o=class extends S{constructor(e){super();this.canvasStore=e}get active(){return v(this.canvasStore.webPageNode,"webPageNode must be defined"),this.canvasStore.webPageNode}};var Qe,Mo=class extends S{constructor(e){super();this.treeStore=e;p(this,"highlightedRenderId");p(this,"nodeInTextEditor");p(this,"proseMirror");p(this,"proseMirrorView",null);At(this,Qe);p(this,"validationWarning")}get tool(){return Le(this,Qe)}set tool(e){Le(this,Qe)!==e&&(Le(this,Qe)?.stop?.(),_t(this,Qe,e))}validateCollectionControl(e){let t="required";if(!e)return;let{collectionItemNode:r,variableDefinition:i,collectionNode:s,controlDescription:f,controlProp:a}=e,d;(yt(i)||Ve(i))&&(d=$t(i,s.variables,r));let c=Qt(s,r),l=i.type,u=eo(l,f,a,d,void 0,Gt(i),c.get(i.id));this.validationWarning=u?.type===t?void 0:u}};Qe=new WeakMap;var Ro=class extends S{constructor(e,t){super();this.activeRouteStore=e;this.undoRedoManager=t;p(this,"layoutCache",new pi);p(this,"sandboxCollectionData",new mi("editor"));p(this,"sandboxVisibility",new ui("editor"));p(this,"_tree",br.createEmpty());p(this,"_domLayoutUpdate",0);p(this,"timeline",new gi(this.tree));p(this,"treeIndexes",new Bn(this))}get tree(){return this._tree}get domLayoutUpdate(){return this._domLayoutUpdate}get remoteTreeVersion(){return this.timeline.remoteTreeVersion}getChangesForUndo(){let e=this.timeline.getLatestChangesForUndo();return e?e.filter(t=>!t.ignoreInUndo):[]}hasChanged(){return this.undoRedoManager.getUndoBufferSize()>0}getPartialIndexes(){return this.treeIndexes}getLoadedIndexes(){let e=this.tree.getService("loader");if(e){let t=e.numberOfScopesToLoad();throw new Error(`Some scopes are still loading: ${t} scopes left to load`)}return this.treeIndexes}onLayoutMeasure(e){let t=this.layoutCache.processLayoutMeasurements(e);t.size===0||hi(this.tree,this.layoutCache,t).size===0||this._domLayoutUpdate++}onSandboxRendered(e){let t=new Set;if(e.collectionUpdates){let r=this.sandboxCollectionData.import(e.collectionUpdates);for(let i of r){let s=Ut(i);t.add(s)}}if(e.visibilityUpdates){let r=this.sandboxVisibility.import(e.visibilityUpdates);for(let i of r){let s=Ut(i);t.add(s)}}if(t.size>0){let r=yi(this.tree,t);Ht(this.tree,this.layoutCache,this.sandboxCollectionData,this.sandboxVisibility,L.activeBundleHash,this.activeRouteStore.localeId,void 0,r)}e.layoutMeasurements&&this.onLayoutMeasure(e.layoutMeasurements)}newTreeAfterRemoteUpdate(e){e.inEditor=!0,this._tree!==e&&(this._tree=e)}newTreeAfterLocalUpdate(e,t){if(e.inEditor=!0,this._tree===e)return;this._tree=e;let r=this.getChangesForUndo();t&&r.length>0&&this.undoRedoManager.addUndoEntry({changes:r})}},Bn=class{constructor(o){this.treeStore=o;p(this,"codeComponentNodeCache");p(this,"richTextNodeCache")}get codeComponents(){let o=this.treeStore.tree;if(this.codeComponentNodeCache?.tree===o)return this.codeComponentNodeCache.codeComponentNodes;let e=[];for(let t of o.root.walk())fe(t)&&e.push(t);return this.codeComponentNodeCache={tree:o,codeComponentNodes:e},e}get richTextNodes(){let o=this.treeStore.tree;if(this.richTextNodeCache?.tree===o)return this.richTextNodeCache.richTextNodes;let e=[];for(let t of o.root.walk())A(t)&&e.push(t);return this.richTextNodeCache={tree:o,richTextNodes:e},e}};var Do=class extends Fi{};var To=class{constructor(o,e){p(this,"accessStore");p(this,"activeRouteStore");p(this,"assetStore");p(this,"canvasStore");p(this,"componentsStore");p(this,"contextMenuStore");p(this,"hostnameStore");p(this,"loadedExternalModulesStore");p(this,"loginStore");p(this,"modalStore");p(this,"modulesStore");p(this,"mouseStore");p(this,"navigationStore");p(this,"projectStore");p(this,"sandboxStore");p(this,"toolStore");p(this,"treeStore");p(this,"scopeStore");p(this,"editableNodeHighlightStore");p(this,"undoRedoManager",new Do);p(this,"changes",new Zt);this.assetStore=bo.new(o),this.editableNodeHighlightStore=ko.new(o),this.activeRouteStore=Fo.new(o,this.editableNodeHighlightStore),this.componentsStore=vo.new(o),this.contextMenuStore=Ci.new(o),this.hostnameStore=Eo.new(o),this.navigationStore=ho.new(o,()=>this.accessStore.access),this.treeStore=Ro.new(o,this.activeRouteStore,this.undoRedoManager),this.projectStore=Bo.new(o,this.assetStore,this.treeStore),this.accessStore=Io.new(o,this.navigationStore,this.projectStore,this.hostnameStore,e),this.loginStore=No.new(o,this.accessStore),this.mouseStore=Oo.new(o),this.toolStore=Mo.new(o,this.treeStore),this.canvasStore=So.new(o,this.accessStore,this.activeRouteStore,this.editableNodeHighlightStore,this.treeStore,this.projectStore,this.undoRedoManager,()=>o.exitTool()),this.scopeStore=_o.new(o,this.canvasStore),this.sandboxStore=Ao.new(o,this.componentsStore,this.treeStore,o.performanceTracker,o.sandboxUpdateGenerator),this.loadedExternalModulesStore=Po.new(o,this.sandboxStore),this.modulesStore=ci.new(o,this.treeStore,this.loadedExternalModulesStore,{codeEditorPreviewVisible:!1,mainView:0},this.projectStore.getProject().then(t=>t.modulesAPI),()=>{throw new Error("Can't make document readonly")},async t=>{await(await this.sandboxStore.getModulesRuntime()).insertTemporaryImportMap(t)},async()=>{throw new Error("Can't load all local modules")}),this.modalStore=Kr.new(o)}};var Go=class{constructor(){p(this,"editorBarReadyAt");p(this,"canvasReadyAt");p(this,"canvasLoaderViewedAt")}get editorBarReadyMs(){let o=Bc();if(!(Ce(o)||Ce(this.editorBarReadyAt)))return this.editorBarReadyAt-o}get canvasReadyMs(){if(!(Ce(this.canvasReadyAt)||Ce(this.editorBarReadyAt)))return this.canvasReadyAt-this.editorBarReadyAt}get perceivedCanvasLoadMs(){if(!Ce(this.canvasReadyAt))return Ce(this.canvasLoaderViewedAt)?0:Math.min(this.canvasReadyAt-this.canvasLoaderViewedAt,0)}reportEditorBarReady(){this.editorBarReadyAt=Date.now()}reportCanvasLoaderViewed(){this.canvasLoaderViewedAt=Date.now()}reportCanvasReady(){this.canvasReadyAt=Date.now(),this.sendCanvasLoadedEvent()}sendCanvasLoadedEvent(){let{canvasReadyMs:o,editorBarReadyMs:e,perceivedCanvasLoadMs:t}=this;Ce(o)||Ce(e)||Ce(t)||K("editor_bar_canvas_loaded",{editorBarReadyMs:e,canvasReadyMs:o,perceivedCanvasLoadMs:t})}};function Bc(){let n=new URLSearchParams(window.location.search).get("loadStart");if(!n)return;let o=Number(n);if(!Number.isNaN(o))return o}var zo=class{constructor(o){this.engine=o;p(this,"partialTreeSender");p(this,"previousWebPageNodeId");p(this,"previousCollectionItemNodeId");p(this,"previousBreakpointNodeId");p(this,"previousStylePresetBreakpointClassNames");p(this,"previousLocalModules");p(this,"previousDependenciesModule");p(this,"previousAssets");p(this,"previousNodeInTextEditor")}getUpdate(){let{canvasStore:o,modulesStore:e,assetStore:t,treeStore:r,toolStore:i}=this.engine.stores,s={},f=o.webPageNode?.id;f!==this.previousWebPageNodeId&&(this.previousWebPageNodeId=f,s.webPageNodeId=f);let a=o.collectionItemNode?.id;a!==this.previousCollectionItemNodeId&&(this.previousCollectionItemNodeId=a,s.collectionItemNodeId=a);let d=o.breakpointNode?.id;d!==this.previousBreakpointNodeId&&(this.previousBreakpointNodeId=d,s.breakpointNodeId=d);let c=o.stylePresetBreakpointClassNames;c!==this.previousStylePresetBreakpointClassNames&&(this.previousStylePresetBreakpointClassNames=c,s.stylePresetBreakpointClassNames=c);let l=e.localModules;l!==this.previousLocalModules&&(this.previousLocalModules=l,s.localModules=new Map(l));let u=e.dependenciesModule;u!==this.previousDependenciesModule&&(this.previousDependenciesModule=u,s.dependenciesModule=u);let w=t.assets;w!==this.previousAssets&&(this.previousAssets=w,s.assets=w),this.partialTreeSender??=new Hr(r.timeline,"canvas");let U=this.partialTreeSender.update(f);Rt(U)||(s.partialTreeUpdate=U);let h=i.nodeInTextEditor??null;return h!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=h,s.nodeInTextEditor=h),s}};var Lo=class{constructor(o){this.siteId=o;p(this,"name","OnPageEngine");p(this,"sandboxUpdateGenerator",new zo(this));p(this,"performanceTracker",new Go);p(this,"stores");p(this,"changes",new Zt);p(this,"animationTimeout");p(this,"inRendering",!1);p(this,"inPostProcessing",!1);p(this,"runWhenIdle",o=>{throw new Error("Not implemented")});p(this,"isUserEdit",!0);this.stores=new To(this,o),this.stores.projectStore.getProject().then(e=>{y(this.stores.assetStore.assetService,"assetsService must be initialized"),fi(this,this.stores.assetStore.assetService,this.stores.projectStore.filePickerRef),Qr(e.api,this.stores.assetStore.assetService),this.stores.modulesStore.initialize().catch(H),e.connection.on("connect",t=>{t&&this.stores.modulesStore.refresh().catch(H)})})}getStateToken(){return this.stores.undoRedoManager.getUndoBufferSize()}get tree(){return this.stores.treeStore.tree}startHighlightTool(){this.stores.toolStore.tool=new Fe(this)}startComponentInstanceEditTool(o,e){this.stores.toolStore.tool=new Ue(this,o,e)}startDateVariableEditTool(o,e,t){this.stores.toolStore.tool=new xe(this,o,e,t)}startImageEditTool(o,e){this.stores.toolStore.tool=new Ie(this,o,e)}startRichTextEditTool(o,e,t){this.stores.toolStore.tool=new pe(this,o,e,t)}startRichTextVariableEditTool(o,e,t){this.stores.toolStore.tool=new me(this,o,e,t)}startStringVariableEditTool(o,e,t){this.stores.toolStore.tool=new ue(this,o,e,t)}exitTool(){this.startHighlightTool()}signalChanges(o){if(this.changes.addChanges(o),this.animationTimeout)return;let e=this.render.bind(this);this.animationTimeout=window.setTimeout(e,0)}render(){if(!this.inRendering&&!this.inPostProcessing){this.inPostProcessing=!0;try{this.changes.has(this.stores.treeStore,this.stores.activeRouteStore)&&Ht(this.stores.treeStore.tree,this.stores.treeStore.layoutCache,this.stores.treeStore.sandboxCollectionData,this.stores.treeStore.sandboxVisibility,L.activeBundleHash,this.stores.activeRouteStore.localeId,void 0,this.stores.activeRouteStore.webPageNodeId),this.stores.toolStore.tool?.update?.(),lr(this.tree)?.postProcess(this.tree),this.stores.undoRedoManager.processScheduledEndUndoGroup({})}finally{this.inPostProcessing=!1}this.inRendering=!0;try{this.stores.sandboxStore.update(),this.changes.signalAllObservers()}finally{this.inRendering=!1}this.animationTimeout=void 0}}undo(){let{undoRedoManager:o,toolStore:e,projectStore:t}=this.stores;e.tool?.undo?e.tool.undo():o.peekUndo()&&(o.undo(this.tree),t.commitTreeAndSend(!1))}redo(){let{undoRedoManager:o,toolStore:e,projectStore:t}=this.stores;e.tool?.redo?e.tool.redo():o.peekRedo()&&(o.redo(this.tree),t.commitTreeAndSend(!1))}beginUndoGroup(){this.stores.undoRedoManager.beginUndoGroup()}endUndoGroup(){this.stores.undoRedoManager.scheduleEndUndoGroup()}wrapHandler(o){let e=this;return function(...t){let r=o.apply(this,t);return e.stores.projectStore.commitTreeAndSend(e.isUserEdit),e.isUserEdit=!0,r}}process(o){this.wrapHandler(o)()}processWhenReady(o){this.wrapHandler(o)()}async processWhenReadyAsync(o){return this.wrapHandler(o)()}runBeforeNextFrame(o){requestAnimationFrame(()=>{o()})}runWithFullyLoadedTree(o,e){y(e.runInBackground,"Only background tasks are supported in the OnPageEngine for now.");let t=this.tree.getService("loader"),r=()=>{o(),this.stores.projectStore.commitTreeAndSend()};if(!t)return r(),rt;let i=t.prioritizeLoadingAllData({operationName:e.name,operationInBackground:!0,doNotTrack:e.doNotTrack}),s=t.afterAllDataLoaded(r);return()=>{i(),s()}}signalNonUserEvent(){this.isUserEdit=!1}};var Ge=m(g());Vn({enableFontStore:!0,fetchGoogleFontsList:Ei,fetchFontshareFontsList:ki,fetchBuiltInFontsList:Si});async function oU(n,o){let e=new Lo(o),{stores:{accessStore:t,sandboxStore:r,assetStore:i}}=e;await t.set(n),X("editorBarOnPageEditing")&&(r.loadSandbox(),wi(i.assetMap),Oe.importFramerFonts(er),si(),Object.assign(window,{engine:e,componentLoader:L})),vi((0,Ge.jsx)(ur.Provider,{value:e,children:(0,Ge.jsx)(Wi,{forceDarkMode:!0,children:(0,Ge.jsx)(qt,{mode:"onPageEditing",children:(0,Ge.jsxs)(Sa,{children:[(0,Ge.jsx)(Sl,{}),(0,Ge.jsx)(Ia,{})]})})})}),document.getElementById("root"))}export{oU as renderEditorBar};
//# sourceMappingURL=https://app.framerstatic.com/render-SODNO4XQ.mjs.map
